{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = 'https://zusheijhebsmjiyyeiqq.supabase.co';\nconst supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp1c2hlaWpoZWJzbWppeXllaXFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4MjI0NDAsImV4cCI6MjA2NzM5ODQ0MH0.iwGPaOJPa6OvwX_iA1xvRt5cM72DWfd8Br1pwRTemRc';\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n\nexport const signInWithEmail = async (email: string, password: string) => {\n  const { data, error } = await supabase.auth.signInWithPassword({\n    email,\n    password,\n  });\n  return { data, error };\n};\n\nexport const signUpWithEmail = async (email: string, password: string) => {\n  const { data, error } = await supabase.auth.signUp({\n    email,\n    password,\n    options: {\n      emailRedirectTo: `${window.location.origin}/auth/callback`,\n    },\n  });\n  return { data, error };\n};\n\n// Function to create admin user without email confirmation\nexport const createAdminUser = async (email: string, password: string) => {\n  const { data, error } = await supabase.auth.signUp({\n    email,\n    password,\n    options: {\n      emailRedirectTo: `${window.location.origin}/auth/callback`,\n      data: {\n        email_confirm: true,\n      },\n    },\n  });\n  return { data, error };\n};\n\nexport const signOut = async () => {\n  await supabase.auth.signOut();\n};\n\nexport const getCurrentUser = async () => {\n  const { data: { user } } = await supabase.auth.getUser();\n  return user;\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,cAAc;AACpB,MAAM,kBAAkB;AAEjB,MAAM,WAAW,CAAA,GAAA,0LAAA,CAAA,eAAY,AAAD,EAAE,aAAa;AAE3C,MAAM,kBAAkB,OAAO,OAAe;IACnD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,kBAAkB,CAAC;QAC7D;QACA;IACF;IACA,OAAO;QAAE;QAAM;IAAM;AACvB;AAEO,MAAM,kBAAkB,OAAO,OAAe;IACnD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,MAAM,CAAC;QACjD;QACA;QACA,SAAS;YACP,iBAAiB,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,cAAc,CAAC;QAC5D;IACF;IACA,OAAO;QAAE;QAAM;IAAM;AACvB;AAGO,MAAM,kBAAkB,OAAO,OAAe;IACnD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,MAAM,CAAC;QACjD;QACA;QACA,SAAS;YACP,iBAAiB,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,cAAc,CAAC;YAC1D,MAAM;gBACJ,eAAe;YACjB;QACF;IACF;IACA,OAAO;QAAE;QAAM;IAAM;AACvB;AAEO,MAAM,UAAU;IACrB,MAAM,SAAS,IAAI,CAAC,OAAO;AAC7B;AAEO,MAAM,iBAAiB;IAC5B,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IACtD,OAAO;AACT","debugId":null}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/barcodeUtils.ts"],"sourcesContent":["import { supabase } from './supabase';\n\n/**\n * Generate a barcode ID for a patient\n * Format: BARS{Year}{Month}{RandomDigits}\n * Example: BARS2025010001\n */\nexport function generateBarcodeId(uhid: string): string {\n  const now = new Date();\n  const year = now.getFullYear().toString();\n  const month = (now.getMonth() + 1).toString().padStart(2, '0');\n  \n  // Use UHID as base and add timestamp for uniqueness\n  const timestamp = now.getTime().toString().slice(-4); // Last 4 digits of timestamp\n  \n  return `BARS${year}${month}${timestamp}`;\n}\n\n/**\n * Generate SVG barcode using Code-128 format\n * This is a simplified implementation - in production, you'd use a proper barcode library\n */\nexport function generateBarcodeSVG(barcodeId: string): string {\n  const width = 300;\n  const height = 80;\n  const barWidth = 2;\n  const barsCount = barcodeId.length * 6; // Approximate for Code-128\n  \n  let svg = `<svg width=\"${width}\" height=\"${height}\" xmlns=\"http://www.w3.org/2000/svg\">`;\n  \n  // Background\n  svg += `<rect width=\"${width}\" height=\"${height}\" fill=\"white\"/>`;\n  \n  // Generate bars pattern (simplified)\n  let x = 10;\n  for (let i = 0; i < barcodeId.length; i++) {\n    const char = barcodeId[i];\n    const charCode = char.charCodeAt(0);\n    \n    // Create alternating pattern based on character\n    for (let j = 0; j < 6; j++) {\n      if ((charCode + j) % 2 === 0) {\n        svg += `<rect x=\"${x}\" y=\"10\" width=\"${barWidth}\" height=\"50\" fill=\"black\"/>`;\n      }\n      x += barWidth;\n    }\n  }\n  \n  // Add text below barcode\n  svg += `<text x=\"${width/2}\" y=\"${height-10}\" text-anchor=\"middle\" font-family=\"monospace\" font-size=\"12\" fill=\"black\">${barcodeId}</text>`;\n  \n  svg += '</svg>';\n  \n  return svg;\n}\n\n/**\n * Generate a more realistic barcode pattern\n * This creates a pattern that looks more like a real barcode\n */\nexport function generateRealisticBarcodeSVG(barcodeId: string): string {\n  const width = 300;\n  const height = 80;\n  const minBarWidth = 1;\n  const maxBarWidth = 4;\n  \n  let svg = `<svg width=\"${width}\" height=\"${height}\" xmlns=\"http://www.w3.org/2000/svg\">`;\n  \n  // Background\n  svg += `<rect width=\"${width}\" height=\"${height}\" fill=\"white\"/>`;\n  \n  // Generate more realistic bar pattern\n  let x = 20;\n  let isBlack = true;\n  \n  // Start and end patterns\n  const startPattern = [1, 1, 1, 1, 1, 1];\n  const endPattern = [1, 1, 1, 1, 1, 1];\n  \n  // Draw start pattern\n  for (const barWidth of startPattern) {\n    if (isBlack) {\n      svg += `<rect x=\"${x}\" y=\"10\" width=\"${barWidth}\" height=\"50\" fill=\"black\"/>`;\n    }\n    x += barWidth;\n    isBlack = !isBlack;\n  }\n  \n  // Draw data pattern\n  for (let i = 0; i < barcodeId.length; i++) {\n    const char = barcodeId[i];\n    const charCode = char.charCodeAt(0);\n    \n    // Create pattern based on character\n    const pattern = [];\n    for (let j = 0; j < 6; j++) {\n      const width = minBarWidth + ((charCode + j) % (maxBarWidth - minBarWidth + 1));\n      pattern.push(width);\n    }\n    \n    for (const barWidth of pattern) {\n      if (isBlack) {\n        svg += `<rect x=\"${x}\" y=\"10\" width=\"${barWidth}\" height=\"50\" fill=\"black\"/>`;\n      }\n      x += barWidth;\n      isBlack = !isBlack;\n    }\n  }\n  \n  // Draw end pattern\n  for (const barWidth of endPattern) {\n    if (isBlack) {\n      svg += `<rect x=\"${x}\" y=\"10\" width=\"${barWidth}\" height=\"50\" fill=\"black\"/>`;\n    }\n    x += barWidth;\n    isBlack = !isBlack;\n  }\n  \n  // Add text below barcode\n  svg += `<text x=\"${width/2}\" y=\"${height-10}\" text-anchor=\"middle\" font-family=\"monospace\" font-size=\"12\" fill=\"black\">${barcodeId}</text>`;\n  \n  svg += '</svg>';\n  \n  return svg;\n}\n\n/**\n * Update patient with barcode ID\n */\nexport async function updatePatientWithBarcode(patientId: string, barcodeId: string): Promise<void> {\n  try {\n    const { error } = await supabase\n      .from('patients')\n      .update({ barcode_id: barcodeId })\n      .eq('patient_id', patientId);\n    \n    if (error) {\n      console.error('Error updating patient with barcode:', error);\n      throw new Error(`Failed to update patient with barcode: ${error.message}`);\n    }\n  } catch (error) {\n    console.error('Error updating patient with barcode:', error);\n    throw error;\n  }\n}\n\n/**\n * Get patient by barcode ID\n */\nexport async function getPatientByBarcodeId(barcodeId: string): Promise<any> {\n  try {\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .select('*')\n      .eq('barcode_id', barcodeId)\n      .single();\n    \n    if (error) {\n      console.error('Error fetching patient by barcode:', error);\n      throw new Error(`Patient not found: ${error.message}`);\n    }\n    \n    return patient;\n  } catch (error) {\n    console.error('Error fetching patient by barcode:', error);\n    throw error;\n  }\n}\n\n/**\n * Generate printable barcode data\n */\nexport function generatePrintableBarcodeData(uhid: string, barcodeId: string, patientName: string): string {\n  const svg = generateRealisticBarcodeSVG(barcodeId);\n  \n  return `\n    <div style=\"width: 4in; height: 2in; padding: 0.2in; font-family: Arial, sans-serif; border: 1px solid #ccc; margin: 0.1in;\">\n      <div style=\"text-align: center; margin-bottom: 0.1in;\">\n        <h3 style=\"margin: 0; font-size: 14px; color: #333;\">ANNAM HOSPITAL</h3>\n        <p style=\"margin: 0; font-size: 10px; color: #666;\">Patient ID Card</p>\n      </div>\n      <div style=\"text-align: center; margin-bottom: 0.1in;\">\n        ${svg}\n      </div>\n      <div style=\"text-align: center; font-size: 12px;\">\n        <p style=\"margin: 0; font-weight: bold;\">${patientName}</p>\n        <p style=\"margin: 0; font-size: 10px; color: #666;\">UHID: ${uhid}</p>\n      </div>\n    </div>\n  `;\n}\n\n/**\n * Validate barcode ID format\n */\nexport function validateBarcodeId(barcodeId: string): boolean {\n  // Check if it matches the format: BARS{Year}{Month}{4digits}\n  const barcodeRegex = /^BARS\\d{4}(0[1-9]|1[0-2])\\d{4}$/;\n  return barcodeRegex.test(barcodeId);\n}\n\n/**\n * Extract information from barcode ID\n */\nexport function extractBarcodeInfo(barcodeId: string): {\n  year: string;\n  month: string;\n  sequence: string;\n} | null {\n  if (!validateBarcodeId(barcodeId)) {\n    return null;\n  }\n  \n  const year = barcodeId.substring(4, 8);\n  const month = barcodeId.substring(8, 10);\n  const sequence = barcodeId.substring(10, 14);\n  \n  return { year, month, sequence };\n}\n\n/**\n * Generate barcode for existing patient\n */\nexport async function generateBarcodeForPatient(patientId: string): Promise<string> {\n  try {\n    // Check if patient already has a barcode\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .select('barcode_id, patient_id')\n      .eq('patient_id', patientId)\n      .single();\n    \n    if (error) {\n      throw new Error(`Patient not found: ${error.message}`);\n    }\n    \n    // If patient already has a barcode, return it\n    if (patient.barcode_id && patient.barcode_id.trim() !== '') {\n      return patient.barcode_id;\n    }\n    \n    // Generate new barcode\n    const barcodeId = generateBarcodeId(patientId);\n    \n    // Update patient with barcode\n    await updatePatientWithBarcode(patientId, barcodeId);\n    \n    return barcodeId;\n  } catch (error) {\n    console.error('Error generating barcode for patient:', error);\n    throw error;\n  }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 282, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/patientService.ts"],"sourcesContent":["import { supabase } from './supabase';\nimport { generateBarcodeId, updatePatientWithBarcode } from './barcodeUtils';\n\n// Types - Updated to match comprehensive registration form\nexport interface PatientRegistrationData {\n  // Personal Information (Mandatory)\n  firstName: string;\n  lastName: string;\n  dateOfBirth: string;\n  gender: string;\n  maritalStatus?: string; // single, married, divorced, widowed, separated\n  phone: string;\n  email?: string;\n  address: string;\n  \n  // Medical & Admission Information \n  bloodGroup: string;\n  allergies: string;\n  medicalHistory: string;\n  currentMedications: string;\n  chronicConditions: string;\n  previousSurgeries: string;\n  \n  // Admission Details\n  admissionDate?: string;\n  admissionTime?: string;\n  primaryComplaint: string;\n  admissionType: string; // emergency, elective, referred\n  referringDoctorFacility?: string;\n  consultingDoctorId?: string;\n  consultingDoctorName?: string;\n  departmentWard?: string;\n  roomNumber?: string;\n  \n  // Guardian/Attendant Details (Optional)\n  guardianName?: string;\n  guardianRelationship?: string;\n  guardianPhone?: string;\n  guardianAddress?: string;\n  \n  // Emergency Contact (Optional)\n  emergencyContactName?: string;\n  emergencyContactPhone?: string;\n  emergencyContactRelationship?: string;\n  \n  // Insurance Information (Optional)\n  insuranceProvider?: string;\n  insuranceNumber?: string;\n  \n  // Initial Visit Information\n  initialSymptoms?: string;\n  referredBy?: string;\n}\n\nexport interface PatientResponse {\n  success: boolean;\n  patient?: any;\n  uhid?: string;\n  credentials?: {\n    email: string;\n    password: string;\n  };\n  error?: string;\n}\n\n/**\n * Generate a unique UHID (Unique Hospital ID) for a new patient\n * Format: UHID + current year + 6-digit sequential number\n * Example: UHID2025000001\n */\nexport async function generateUHID(): Promise<string> {\n  const now = new Date();\n  const yearTwoDigits = now.getFullYear().toString().slice(-2); // Last two digits of year\n  const month = (now.getMonth() + 1).toString().padStart(2, '0'); // Month with leading zero\n  \n  try {\n    // Generate a unique 4-digit random number\n    let uhid: string = '';\n    let isUnique = false;\n    let attempts = 0;\n    const maxAttempts = 1000;\n    \n    while (!isUnique && attempts < maxAttempts) {\n      // Generate 4-digit random number\n      const randomNumber = Math.floor(Math.random() * 10000).toString().padStart(4, '0');\n      uhid = `AH${yearTwoDigits}${month}${randomNumber}`;\n      \n      // Check if this UHID already exists\n      const { data: existing, error } = await supabase\n        .from('patients')\n        .select('patient_id')\n        .eq('patient_id', uhid)\n        .single();\n      \n      if (error && error.code === 'PGRST116') {\n        // No record found, UHID is unique\n        isUnique = true;\n      } else if (error) {\n        console.error('Error checking UHID uniqueness:', error);\n        throw new Error('Failed to generate UHID');\n      }\n      \n      attempts++;\n    }\n    \n    if (!isUnique) {\n      throw new Error('Failed to generate unique UHID after maximum attempts');\n    }\n    \n    return uhid;\n  } catch (error) {\n    console.error('Error generating UHID:', error);\n    throw new Error('Failed to generate UHID');\n  }\n}\n\n/**\n * Create authentication credentials for a new patient\n * Email format: UHID@annam.com\n * Password: \"password\" (as specified in requirements)\n */\nexport async function createPatientAuthCredentials(uhid: string): Promise<{ \n  authUser: any; \n  credentials: { email: string; password: string } \n}> {\n  const email = `${uhid}@annam.com`;\n  const password = 'password';\n\n  try {\n    // Create auth user using Supabase Admin API\n    const { data: authUser, error: authError } = await supabase.auth.signUp({\n      email,\n      password,\n      options: {\n        emailRedirectTo: `${window.location.origin}/auth/callback`,\n        data: {\n          role: 'patient',\n          uhid: uhid,\n          email_confirm: true\n        }\n      }\n    });\n\n    if (authError) {\n      console.error('Error creating auth user:', authError);\n      throw new Error(`Failed to create authentication: ${authError.message}`);\n    }\n\n    return {\n      authUser: authUser.user,\n      credentials: { email, password }\n    };\n  } catch (error) {\n    console.error('Error creating patient auth credentials:', error);\n    throw error;\n  }\n}\n\n/**\n * Insert comprehensive patient record into the patients table with all new fields\n */\nexport async function insertPatientRecord(\n  uhid: string, \n  registrationData: PatientRegistrationData,\n  userId?: string\n): Promise<any> {\n  try {\n    const fullName = `${registrationData.firstName} ${registrationData.lastName}`;\n    \n    // Generate barcode ID\n    const barcodeId = generateBarcodeId(uhid);\n    \n    // Prepare admission date and time\n    let admissionDateTime = null;\n    if (registrationData.admissionDate) {\n      if (registrationData.admissionTime) {\n        admissionDateTime = `${registrationData.admissionDate}T${registrationData.admissionTime}`;\n      } else {\n        admissionDateTime = `${registrationData.admissionDate}T00:00:00`;\n      }\n    }\n    \n    const patientData = {\n      // Basic Information\n      patient_id: uhid,\n      barcode_id: barcodeId, // Add barcode ID\n      name: fullName,\n      date_of_birth: registrationData.dateOfBirth,\n      gender: registrationData.gender.toLowerCase(),\n      marital_status: registrationData.maritalStatus || null,\n      phone: registrationData.phone,\n      email: registrationData.email || `${uhid}@annam.com`,\n      address: registrationData.address,\n      \n      // Medical Information\n      blood_group: registrationData.bloodGroup || null,\n      allergies: registrationData.allergies || null,\n      medical_history: registrationData.medicalHistory || null,\n      current_medications: registrationData.currentMedications || null,\n      chronic_conditions: registrationData.chronicConditions || null,\n      previous_surgeries: registrationData.previousSurgeries || null,\n      \n      // New Admission Information\n      admission_date: admissionDateTime,\n      admission_time: registrationData.admissionTime || null,\n      primary_complaint: registrationData.primaryComplaint,\n      admission_type: registrationData.admissionType,\n      referring_doctor_facility: registrationData.referringDoctorFacility || null,\n      department_ward: registrationData.departmentWard || null,\n      room_number: registrationData.roomNumber || null,\n      \n      // Guardian/Attendant Details (Optional)\n      guardian_name: registrationData.guardianName || null,\n      guardian_relationship: registrationData.guardianRelationship || null,\n      guardian_phone: registrationData.guardianPhone || null,\n      guardian_address: registrationData.guardianAddress || null,\n      \n      // Emergency Contact (Optional)\n      emergency_contact_name: registrationData.emergencyContactName || null,\n      emergency_contact_phone: registrationData.emergencyContactPhone || null,\n      emergency_contact_relationship: registrationData.emergencyContactRelationship || null,\n      \n      // Insurance Information\n      insurance_number: registrationData.insuranceNumber || null,\n      insurance_provider: registrationData.insuranceProvider || null,\n      \n      // Additional fields\n      initial_symptoms: registrationData.initialSymptoms || null,\n      referred_by: registrationData.referredBy || null,\n      \n      // Link to users table\n      user_id: userId || null,\n      \n      // System fields\n      status: 'active'\n    };\n\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .insert([patientData])\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error inserting patient record:', error);\n      throw new Error(`Failed to create patient record: ${error.message}`);\n    }\n\n    return patient;\n  } catch (error) {\n    console.error('Error inserting patient record:', error);\n    throw error;\n  }\n}\n\n/**\n * Link the Supabase auth user to the users table for role management\n */\nexport async function linkAuthUserToPatient(\n  authUserId: string, \n  uhid: string, \n  registrationData: PatientRegistrationData\n): Promise<any> {\n  try {\n    const fullName = `${registrationData.firstName} ${registrationData.lastName}`;\n    \n    const userData = {\n      auth_id: authUserId,\n      employee_id: uhid, // Using UHID as employee_id for patients\n      name: fullName,\n      email: registrationData.email || `${uhid}@annam.com`,\n      role: 'patient',\n      phone: registrationData.phone,\n      address: registrationData.address,\n      status: 'active',\n      permissions: {\n        patient_portal: true,\n        view_own_records: true,\n        book_appointments: true\n      }\n    };\n\n    const { data: user, error } = await supabase\n      .from('users')\n      .insert([userData])\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error linking auth user to patient:', error);\n      throw new Error(`Failed to create user record: ${error.message}`);\n    }\n\n    return user;\n  } catch (error) {\n    console.error('Error linking auth user to patient:', error);\n    throw error;\n  }\n}\n\n/**\n * Create an initial appointment if symptoms are provided\n */\nexport async function createInitialAppointment(\n  patientId: string,\n  registrationData: PatientRegistrationData\n): Promise<any> {\n  try {\n    if (!registrationData.initialSymptoms?.trim() && !registrationData.primaryComplaint?.trim()) {\n      return null; // No appointment needed if no symptoms\n    }\n\n    // Generate appointment ID\n    const appointmentId = `APT${Date.now()}`;\n    \n    // Use tomorrow as default appointment date\n    const tomorrow = new Date();\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    \n    const appointmentData = {\n      appointment_id: appointmentId,\n      patient_id: patientId,\n      appointment_date: tomorrow.toISOString().split('T')[0],\n      appointment_time: '09:00:00',\n      type: 'consultation',\n      status: 'scheduled',\n      symptoms: registrationData.initialSymptoms || registrationData.primaryComplaint,\n      notes: `Initial consultation for newly registered patient. Primary complaint: ${registrationData.primaryComplaint}`\n    };\n\n    const { data: appointment, error } = await supabase\n      .from('appointments')\n      .insert([appointmentData])\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error creating initial appointment:', error);\n      // Don't throw error for appointment creation failure\n      return null;\n    }\n\n    return appointment;\n  } catch (error) {\n    console.error('Error creating initial appointment:', error);\n    // Don't throw error for appointment creation failure\n    return null;\n  }\n}\n\n/**\n * Main function to register a new patient with complete workflow\n */\nexport async function registerNewPatient(\n  registrationData: PatientRegistrationData,\n  preGeneratedUHID?: string\n): Promise<PatientResponse> {\n  try {\n    // Step 1: Use pre-generated UHID or generate new one\n    const uhid = preGeneratedUHID || await generateUHID();\n    console.log('Using UHID:', uhid);\n\n    // Step 2: Create authentication credentials\n    const { authUser, credentials } = await createPatientAuthCredentials(uhid);\n    console.log('Created auth user:', authUser?.id);\n\n    // Step 3: Create user record in users table\n    const userRecord = await linkAuthUserToPatient(authUser.id, uhid, registrationData);\n    console.log('Created user record:', userRecord.id);\n\n    // Step 4: Insert patient record with user_id link\n    const patient = await insertPatientRecord(uhid, registrationData, userRecord.id);\n    console.log('Created patient record:', patient.id);\n\n    // Step 5: Create initial appointment if symptoms provided\n    if (registrationData.initialSymptoms?.trim() || registrationData.primaryComplaint?.trim()) {\n      const appointment = await createInitialAppointment(patient.id, registrationData);\n      if (appointment) {\n        console.log('Created initial appointment:', appointment.id);\n      }\n    }\n\n    return {\n      success: true,\n      patient,\n      uhid,\n      credentials,\n    };\n\n  } catch (error) {\n    console.error('Error registering new patient:', error);\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error occurred'\n    };\n  }\n}\n\n/**\n * Validate that UHID is unique\n */\nexport async function validateUHIDUnique(uhid: string): Promise<boolean> {\n  try {\n    const { data: existingPatient, error } = await supabase\n      .from('patients')\n      .select('patient_id')\n      .eq('patient_id', uhid)\n      .single();\n\n    if (error && error.code !== 'PGRST116') {\n      console.error('Error validating UHID uniqueness:', error);\n      throw new Error('Failed to validate UHID');\n    }\n\n    return !existingPatient; // Return true if no existing patient found\n  } catch (error) {\n    console.error('Error validating UHID uniqueness:', error);\n    throw error;\n  }\n}\n\n/**\n * Get patient by UHID with comprehensive data\n */\nexport async function getPatientByUHID(uhid: string): Promise<any> {\n  try {\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .select('*')\n      .eq('patient_id', uhid)\n      .single();\n\n    if (error) {\n      console.error('Error fetching patient by UHID:', error);\n      throw new Error(`Patient not found: ${error.message}`);\n    }\n\n    return patient;\n  } catch (error) {\n    console.error('Error fetching patient by UHID:', error);\n    throw error;\n  }\n}\n\n/**\n * Get patient with related data (appointments, bills, etc.)\n */\nexport async function getPatientWithRelatedData(uhid: string): Promise<any> {\n  try {\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .select(`\n        *,\n        users:user_id (\n          id,\n          name,\n          email,\n          role,\n          status,\n          permissions\n        ),\n        appointments:appointments(\n          id,\n          appointment_id,\n          appointment_date,\n          appointment_time,\n          type,\n          status,\n          symptoms,\n          diagnosis,\n          doctor:doctors(\n            id,\n            user:users(name, specialization)\n          )\n        ),\n        bed_allocations:bed_allocations(\n          id,\n          admission_date,\n          discharge_date,\n          admission_type,\n          status,\n          bed:beds(bed_number, room_number, bed_type),\n          doctor:doctors(\n            id,\n            user:users(name, specialization)\n          )\n        )\n      `)\n      .eq('patient_id', uhid)\n      .single();\n\n    if (error) {\n      console.error('Error fetching patient with related data:', error);\n      throw new Error(`Patient not found: ${error.message}`);\n    }\n\n    return patient;\n  } catch (error) {\n    console.error('Error fetching patient with related data:', error);\n    throw error;\n  }\n}\n\n/**\n * Update patient information\n */\nexport async function updatePatientRecord(\n  uhid: string, \n  updateData: any\n): Promise<any> {\n  try {\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .update(updateData)\n      .eq('patient_id', uhid)\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error updating patient record:', error);\n      throw new Error(`Failed to update patient: ${error.message}`);\n    }\n\n    return patient;\n  } catch (error) {\n    console.error('Error updating patient record:', error);\n    throw error;\n  }\n}\n\n/**\n * Get all patients with pagination and filtering\n */\nexport async function getAllPatients(\n  options: {\n    page?: number;\n    limit?: number;\n    status?: string;\n    searchTerm?: string;\n  } = {}\n): Promise<{ patients: any[]; total: number; page: number; limit: number }> {\n  try {\n    const { page = 1, limit = 20, status, searchTerm } = options;\n    const offset = (page - 1) * limit;\n\n    let query = supabase\n      .from('patients')\n      .select(`\n        *,\n        users:user_id (\n          id,\n          name,\n          email,\n          role,\n          status,\n          permissions\n        )\n      `, { count: 'exact' });\n\n    // Apply filters\n    if (status) {\n      query = query.eq('status', status);\n    }\n\n    if (searchTerm) {\n      query = query.or(`name.ilike.%${searchTerm}%,patient_id.ilike.%${searchTerm}%,phone.ilike.%${searchTerm}%`);\n    }\n\n    // Apply pagination\n    const { data: patients, error, count } = await query\n      .range(offset, offset + limit - 1)\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      console.error('Error fetching patients:', error);\n      throw new Error(`Failed to fetch patients: ${error.message}`);\n    }\n\n    return {\n      patients: patients || [],\n      total: count || 0,\n      page,\n      limit\n    };\n  } catch (error) {\n    console.error('Error fetching patients:', error);\n    throw error;\n  }\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 680, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/vitalsService.ts"],"sourcesContent":["import { supabase } from './supabase';\n\n// Types for vitals management\nexport interface VitalSigns {\n  patientId: string;\n  visitId?: string;\n  recordedBy?: string; // Made optional to allow null values\n  \n  // Primary vital signs\n  systolicBp?: number;\n  diastolicBp?: number;\n  heartRate?: number;\n  temperature?: number;\n  respiratoryRate?: number;\n  oxygenSaturation?: number;\n  \n  // Physical measurements\n  weight?: number;\n  height?: number;\n  bmi?: number;\n  \n  // Additional measurements\n  bloodGlucose?: number;\n  painScale?: number; // 0-10 scale\n  \n  // Timestamps\n  recordedAt?: string;\n  \n  // Notes\n  notes?: string;\n}\n\nexport interface VitalRecord {\n  id: string;\n  patient_id: string;\n  // visit_id field removed as it doesn't exist in the database\n  recorded_by: string;\n  \n  // Vital signs\n  systolic_bp?: number;\n  diastolic_bp?: number;\n  heart_rate?: number;\n  temperature?: number;\n  respiratory_rate?: number;\n  oxygen_saturation?: number;\n  weight?: number;\n  height?: number;\n  bmi?: number;\n  blood_glucose?: number;\n  pain_scale?: number;\n  \n  // Timestamps\n  recorded_at: string;\n  \n  // Notes\n  notes?: string;\n  \n  // System fields\n  created_at: string;\n  \n  // Related data\n  patient?: any;\n  user?: { name: string };\n  visit?: any;\n}\n\nexport interface VitalTrends {\n  dates: string[];\n  heartRate: number[];\n  bloodPressure: { systolic: number; diastolic: number }[];\n  temperature: number[];\n  weight: number[];\n  oxygenSaturation: number[];\n}\n\n/**\n * Record new vital signs\n */\nexport async function recordVitals(vitalsData: VitalSigns): Promise<VitalRecord> {\n  try {\n    // Calculate BMI if height and weight are provided\n    let bmi = vitalsData.bmi;\n    if (vitalsData.height && vitalsData.weight) {\n      const heightInMeters = vitalsData.height / 100;\n      bmi = vitalsData.weight / (heightInMeters * heightInMeters);\n      bmi = Math.round(bmi * 10) / 10; // Round to 1 decimal place\n    }\n\n    const vitalRecord = {\n      patient_id: vitalsData.patientId,\n      recorded_by: vitalsData.recordedBy || null,\n      systolic_bp: vitalsData.systolicBp || null,\n      diastolic_bp: vitalsData.diastolicBp || null,\n      heart_rate: vitalsData.heartRate || null,\n      temperature: vitalsData.temperature || null,\n      respiratory_rate: vitalsData.respiratoryRate || null,\n      oxygen_saturation: vitalsData.oxygenSaturation || null,\n      weight: vitalsData.weight || null,\n      height: vitalsData.height || null,\n      bmi: bmi || null,\n      blood_glucose: vitalsData.bloodGlucose || null,\n      pain_scale: vitalsData.painScale || null,\n      recorded_at: vitalsData.recordedAt || new Date().toISOString(),\n      notes: vitalsData.notes || null\n    };\n\n    const { data: vital, error } = await supabase\n      .from('vitals')\n      .insert([vitalRecord])\n      .select('*')\n      .single();\n\n    if (error) {\n      console.error('Error recording vitals:', error);\n      throw new Error(`Failed to record vitals: ${error.message}`);\n    }\n\n    return vital;\n  } catch (error) {\n    console.error('Error recording vitals:', error);\n    throw error;\n  }\n}\n\n/**\n * Get patient vitals history\n */\nexport const getPatientVitals = async (patientId: string): Promise<VitalRecord[]> => {\n  try {\n    const { data: vitals, error } = await supabase\n      .from('vitals')\n      .select(`\n        *,\n        patient:patients(id, patient_id, name),\n        user:recorded_by(name)\n      `)\n      .eq('patient_id', patientId)\n      .order('recorded_at', { ascending: false });\n\n    if (error) {\n      // Handle case where vitals table doesn't exist\n      if (error.code === '42P01' || error.code === 'PGRST200') {\n        console.log('Vitals table does not exist, returning empty array');\n        return [];\n      }\n      console.error('Error fetching vitals:', error);\n      throw new Error('Failed to fetch vitals');\n    }\n\n    return (vitals || []) as VitalRecord[];\n  } catch (err: any) {\n    // Handle database connection or table access errors\n    if (err.message?.includes('relation') && err.message?.includes('does not exist')) {\n      console.log('Vitals table does not exist, returning empty array');\n      return [];\n    }\n    console.error('Exception in getPatientVitals:', err);\n    throw err;\n  }\n};\n\n/**\n * Get latest vitals for a patient\n */\nexport async function getLatestVitals(patientId: string): Promise<VitalRecord | null> {\n  try {\n    const { data: vital, error } = await supabase\n      .from('vitals')\n      .select(`\n        *,\n        patient:patients(id, patient_id, name),\n        recorded_by_user:users!recorded_by(id, name, role),\n        visit:patient_visits(id, visit_id, visit_date, visit_type)\n      `)\n      .eq('patient_id', patientId)\n      .order('recorded_at', { ascending: false })\n      .limit(1)\n      .single();\n\n    if (error) {\n      // Handle case where vitals table doesn't exist\n      if (error.code === '42P01' || error.code === 'PGRST200') {\n        console.log('Vitals table does not exist, returning null');\n        return null;\n      }\n      if (error.code !== 'PGRST116') {\n        console.error('Error fetching latest vitals:', error);\n        throw new Error(`Failed to fetch latest vitals: ${error.message}`);\n      }\n    }\n\n    return vital || null;\n  } catch (error: any) {\n    // Handle database connection or table access errors\n    if (error.message?.includes('relation') && error.message?.includes('does not exist')) {\n      console.log('Vitals table does not exist, returning null');\n      return null;\n    }\n    console.error('Error fetching latest vitals:', error);\n    throw error;\n  }\n}\n\n/**\n * Get vitals trends for analysis\n */\nexport async function getVitalsTrends(\n  patientId: string,\n  days: number = 30\n): Promise<VitalTrends> {\n  try {\n    const endDate = new Date();\n    const startDate = new Date();\n    startDate.setDate(startDate.getDate() - days);\n\n    const { data: vitals, error } = await supabase\n      .from('vitals')\n      .select('recorded_at, systolic_bp, diastolic_bp, heart_rate, temperature, weight, oxygen_saturation')\n      .eq('patient_id', patientId)\n      .gte('recorded_at', startDate.toISOString())\n      .lte('recorded_at', endDate.toISOString())\n      .order('recorded_at', { ascending: true });\n\n    if (error) {\n      console.error('Error fetching vitals trends:', error);\n      throw new Error(`Failed to fetch vitals trends: ${error.message}`);\n    }\n\n    const trends: VitalTrends = {\n      dates: [],\n      heartRate: [],\n      bloodPressure: [],\n      temperature: [],\n      weight: [],\n      oxygenSaturation: []\n    };\n\n    vitals?.forEach(vital => {\n      const date = new Date(vital.recorded_at).toISOString().split('T')[0];\n      trends.dates.push(date);\n      \n      trends.heartRate.push(vital.heart_rate || 0);\n      trends.bloodPressure.push({\n        systolic: vital.systolic_bp || 0,\n        diastolic: vital.diastolic_bp || 0\n      });\n      trends.temperature.push(vital.temperature || 0);\n      trends.weight.push(vital.weight || 0);\n      trends.oxygenSaturation.push(vital.oxygen_saturation || 0);\n    });\n\n    return trends;\n  } catch (error) {\n    console.error('Error fetching vitals trends:', error);\n    throw error;\n  }\n}\n\n/**\n * Get vital statistics\n */\nexport async function getVitalStats(\n  patientId: string,\n  vitalType: 'heart_rate' | 'systolic_bp' | 'diastolic_bp' | 'temperature' | 'weight' | 'oxygen_saturation',\n  days: number = 30\n): Promise<{\n  current: number | null;\n  average: number;\n  min: number;\n  max: number;\n  readings: number;\n}> {\n  try {\n    const endDate = new Date();\n    const startDate = new Date();\n    startDate.setDate(startDate.getDate() - days);\n\n    const { data: vitals, error } = await supabase\n      .from('vitals')\n      .select(`recorded_at, ${vitalType}`)\n      .eq('patient_id', patientId)\n      .gte('recorded_at', startDate.toISOString())\n      .lte('recorded_at', endDate.toISOString())\n      .not(vitalType, 'is', null)\n      .order('recorded_at', { ascending: false });\n\n    if (error) {\n      console.error('Error fetching vital stats:', error);\n      throw new Error(`Failed to fetch vital stats: ${error.message}`);\n    }\n\n    const values = vitals?.map(v => (v as any)[vitalType] as number).filter(v => v !== null) || [];\n    \n    if (values.length === 0) {\n      return {\n        current: null,\n        average: 0,\n        min: 0,\n        max: 0,\n        readings: 0\n      };\n    }\n\n    const current = values[0];\n    const average = values.reduce((sum, val) => sum + val, 0) / values.length;\n    const min = Math.min(...values);\n    const max = Math.max(...values);\n\n    return {\n      current,\n      average: Math.round(average * 10) / 10,\n      min,\n      max,\n      readings: values.length\n    };\n  } catch (error) {\n    console.error('Error fetching vital stats:', error);\n    throw error;\n  }\n}\n\n/**\n * Check for vital alerts/abnormalities\n */\nexport async function checkVitalAlerts(patientId: string): Promise<{\n  alerts: Array<{\n    type: string;\n    message: string;\n    severity: 'low' | 'medium' | 'high' | 'critical';\n    value: number;\n    normalRange: string;\n  }>;\n}> {\n  try {\n    const latestVital = await getLatestVitals(patientId);\n    \n    if (!latestVital) {\n      return { alerts: [] };\n    }\n\n    const alerts: Array<{\n      type: string;\n      message: string;\n      severity: 'low' | 'medium' | 'high' | 'critical';\n      value: number;\n      normalRange: string;\n    }> = [];\n\n    // Blood pressure alerts\n    if (latestVital.systolic_bp && latestVital.diastolic_bp) {\n      const systolic = latestVital.systolic_bp;\n      const diastolic = latestVital.diastolic_bp;\n      \n      if (systolic >= 180 || diastolic >= 110) {\n        alerts.push({\n          type: 'blood_pressure',\n          message: 'Hypertensive Crisis - Immediate attention required',\n          severity: 'critical',\n          value: systolic,\n          normalRange: '90-139/60-89 mmHg'\n        });\n      } else if (systolic >= 140 || diastolic >= 90) {\n        alerts.push({\n          type: 'blood_pressure',\n          message: 'High Blood Pressure',\n          severity: 'high',\n          value: systolic,\n          normalRange: '90-139/60-89 mmHg'\n        });\n      } else if (systolic < 90 || diastolic < 60) {\n        alerts.push({\n          type: 'blood_pressure',\n          message: 'Low Blood Pressure',\n          severity: 'medium',\n          value: systolic,\n          normalRange: '90-139/60-89 mmHg'\n        });\n      }\n    }\n\n    // Heart rate alerts\n    if (latestVital.heart_rate) {\n      const hr = latestVital.heart_rate;\n      if (hr > 100) {\n        alerts.push({\n          type: 'heart_rate',\n          message: 'Tachycardia - Elevated heart rate',\n          severity: hr > 120 ? 'high' : 'medium',\n          value: hr,\n          normalRange: '60-100 bpm'\n        });\n      } else if (hr < 60) {\n        alerts.push({\n          type: 'heart_rate',\n          message: 'Bradycardia - Low heart rate',\n          severity: hr < 50 ? 'high' : 'medium',\n          value: hr,\n          normalRange: '60-100 bpm'\n        });\n      }\n    }\n\n    // Temperature alerts\n    if (latestVital.temperature) {\n      const temp = latestVital.temperature;\n      if (temp >= 39.0) {\n        alerts.push({\n          type: 'temperature',\n          message: 'High Fever',\n          severity: 'high',\n          value: temp,\n          normalRange: '36.1-37.2C'\n        });\n      } else if (temp >= 38.0) {\n        alerts.push({\n          type: 'temperature',\n          message: 'Fever',\n          severity: 'medium',\n          value: temp,\n          normalRange: '36.1-37.2C'\n        });\n      } else if (temp < 36.0) {\n        alerts.push({\n          type: 'temperature',\n          message: 'Low body temperature',\n          severity: 'medium',\n          value: temp,\n          normalRange: '36.1-37.2C'\n        });\n      }\n    }\n\n    // Oxygen saturation alerts\n    if (latestVital.oxygen_saturation) {\n      const spo2 = latestVital.oxygen_saturation;\n      if (spo2 < 90) {\n        alerts.push({\n          type: 'oxygen_saturation',\n          message: 'Low oxygen saturation - Immediate attention required',\n          severity: 'critical',\n          value: spo2,\n          normalRange: '95-100%'\n        });\n      } else if (spo2 < 95) {\n        alerts.push({\n          type: 'oxygen_saturation',\n          message: 'Below normal oxygen saturation',\n          severity: 'high',\n          value: spo2,\n          normalRange: '95-100%'\n        });\n      }\n    }\n\n    return { alerts };\n  } catch (error) {\n    console.error('Error checking vital alerts:', error);\n    throw error;\n  }\n}\n\n/**\n * Get vitals summary for dashboard\n */\nexport async function getVitalsSummary(patientId: string): Promise<{\n  latestVitals: VitalRecord | null;\n  alerts: Array<{\n    type: string;\n    message: string;\n    severity: 'low' | 'medium' | 'high' | 'critical';\n    value: number;\n    normalRange: string;\n  }>;\n  totalReadings: number;\n  lastRecordedAt: string | null;\n}> {\n  try {\n    const [latestVitals, alertsData, totalCount] = await Promise.all([\n      getLatestVitals(patientId),\n      checkVitalAlerts(patientId),\n      supabase\n        .from('vitals')\n        .select('id', { count: 'exact', head: true })\n        .eq('patient_id', patientId)\n    ]);\n\n    return {\n      latestVitals,\n      alerts: alertsData.alerts,\n      totalReadings: totalCount.count || 0,\n      lastRecordedAt: latestVitals?.recorded_at || null\n    };\n  } catch (error) {\n    console.error('Error getting vitals summary:', error);\n    throw error;\n  }\n}\n\n/**\n * Update vital record\n */\nexport async function updateVitalRecord(\n  vitalId: string,\n  updates: Partial<VitalSigns>\n): Promise<VitalRecord> {\n  try {\n    // Calculate BMI if height and weight are provided\n    let bmi = updates.bmi;\n    if (updates.height && updates.weight) {\n      const heightInMeters = updates.height / 100;\n      bmi = updates.weight / (heightInMeters * heightInMeters);\n      bmi = Math.round(bmi * 10) / 10; // Round to 1 decimal place\n    }\n\n    const updateData: any = {};\n    \n    if (updates.systolicBp !== undefined) updateData.systolic_bp = updates.systolicBp;\n    if (updates.diastolicBp !== undefined) updateData.diastolic_bp = updates.diastolicBp;\n    if (updates.heartRate !== undefined) updateData.heart_rate = updates.heartRate;\n    if (updates.temperature !== undefined) updateData.temperature = updates.temperature;\n    if (updates.respiratoryRate !== undefined) updateData.respiratory_rate = updates.respiratoryRate;\n    if (updates.oxygenSaturation !== undefined) updateData.oxygen_saturation = updates.oxygenSaturation;\n    if (updates.weight !== undefined) updateData.weight = updates.weight;\n    if (updates.height !== undefined) updateData.height = updates.height;\n    if (bmi !== undefined) updateData.bmi = bmi;\n    if (updates.bloodGlucose !== undefined) updateData.blood_glucose = updates.bloodGlucose;\n    if (updates.painScale !== undefined) updateData.pain_scale = updates.painScale;\n    if (updates.notes !== undefined) updateData.notes = updates.notes;\n\n    const { data: vital, error } = await supabase\n      .from('vitals')\n      .update(updateData)\n      .eq('id', vitalId)\n      .select(`\n        *,\n        patient:patients(id, patient_id, name),\n        recorded_by_user:users!recorded_by(id, name, role),\n        visit:patient_visits(id, visit_id, visit_date, visit_type)\n      `)\n      .single();\n\n    if (error) {\n      console.error('Error updating vital record:', error);\n      throw new Error(`Failed to update vital record: ${error.message}`);\n    }\n\n    return vital;\n  } catch (error) {\n    console.error('Error updating vital record:', error);\n    throw error;\n  }\n}\n\n/**\n * Delete vital record\n */\nexport async function deleteVitalRecord(vitalId: string): Promise<void> {\n  try {\n    const { error } = await supabase\n      .from('vitals')\n      .delete()\n      .eq('id', vitalId);\n\n    if (error) {\n      console.error('Error deleting vital record:', error);\n      throw new Error(`Failed to delete vital record: ${error.message}`);\n    }\n  } catch (error) {\n    console.error('Error deleting vital record:', error);\n    throw error;\n  }\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1067, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/medicalHistoryService.ts"],"sourcesContent":["import { supabase } from './supabase';\n\nexport interface MedicalHistoryEvent {\n  id: string;\n  patient_id: string;\n  event_type: string;\n  event_name: string;\n  event_date: string;\n  details: string | null;\n  doctor_name: string | null;\n  facility_name: string | null;\n  source: 'history' | 'symptom' | 'allergy';\n}\n\nexport interface CreateMedicalHistoryInput {\n  patientId: string;\n  eventType: string;\n  eventName: string;\n  eventDate: string;\n  details?: string;\n  doctorName?: string;\n  facilityName?: string;\n}\n\nexport const createMedicalHistory = async (input: CreateMedicalHistoryInput): Promise<MedicalHistoryEvent> => {\n  if (!input.patientId) {\n    throw new Error('Patient ID is required to create medical history.');\n  }\n\n  try {\n    const { data, error } = await supabase\n      .from('medical_history')\n      .insert({\n        patient_id: input.patientId,\n        event_type: input.eventType,\n        event_name: input.eventName,\n        event_date: input.eventDate,\n        details: input.details || null,\n        doctor_name: input.doctorName || null,\n        facility_name: input.facilityName || null\n      })\n      .select()\n      .single();\n\n    if (error) {\n      // Handle case where medical_history table doesn't exist\n      if (error.code === '42P01') {\n        throw new Error('Medical history table does not exist. Please contact system administrator.');\n      }\n      console.error('Error creating medical history:', error);\n      throw new Error('Failed to create medical history entry.');\n    }\n\n    return { ...data, source: 'history' };\n  } catch (error) {\n    console.error('An unexpected error occurred while creating medical history:', error);\n    throw error;\n  }\n};\n\n// Add some dummy medical history data for testing\nexport const addDummyMedicalHistory = async (patientId: string): Promise<MedicalHistoryEvent[]> => {\n  const dummyData: CreateMedicalHistoryInput[] = [\n    {\n      patientId,\n      eventType: 'Diagnosis',\n      eventName: 'Hypertension',\n      eventDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(), // 30 days ago\n      details: 'Diagnosed with Stage 1 Hypertension. Prescribed lifestyle changes and monitoring.',\n      doctorName: 'Dr. Sarah Johnson',\n      facilityName: 'City General Hospital'\n    },\n    {\n      patientId,\n      eventType: 'Surgery',\n      eventName: 'Appendectomy',\n      eventDate: new Date(Date.now() - 180 * 24 * 60 * 60 * 1000).toISOString(), // 6 months ago\n      details: 'Laparoscopic appendectomy performed due to acute appendicitis. Recovery was uneventful.',\n      doctorName: 'Dr. Michael Chen',\n      facilityName: 'University Medical Center'\n    },\n    {\n      patientId,\n      eventType: 'Vaccination',\n      eventName: 'COVID-19 Vaccine',\n      eventDate: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000).toISOString(), // 3 months ago\n      details: 'Received second dose of COVID-19 vaccine. No adverse reactions reported.',\n      doctorName: 'Dr. Lisa Wong',\n      facilityName: 'Community Health Clinic'\n    }\n  ];\n\n  const results: MedicalHistoryEvent[] = [];\n  \n  for (const entry of dummyData) {\n    try {\n      const result = await createMedicalHistory(entry);\n      results.push(result);\n    } catch (error) {\n      console.error('Error adding dummy data:', error);\n    }\n  }\n\n  return results;\n};\n\nexport const getMedicalHistory = async (patientId: string): Promise<MedicalHistoryEvent[]> => {\n  if (!patientId) {\n    console.error('Patient ID is required to fetch medical history.');\n    return [];\n  }\n\n  try {\n    // Initialize combined history array\n    const combinedHistory: MedicalHistoryEvent[] = [];\n\n    // Fetch from medical_history table (handle if table doesn't exist)\n    try {\n      const { data: historyData, error: historyError } = await supabase\n        .from('medical_history')\n        .select('*')\n        .eq('patient_id', patientId);\n\n      if (historyError) {\n        if (historyError.code === '42P01') {\n          console.log('Medical history table does not exist, skipping');\n        } else if (historyError.code !== 'PGRST116') {\n          console.error('Error fetching medical history:', historyError);\n        }\n      } else if (historyData) {\n        historyData.forEach((item: any) => {\n          combinedHistory.push({ ...item, source: 'history' as const });\n        });\n      }\n    } catch (err: any) {\n      if (err.message?.includes('relation') && err.message?.includes('does not exist')) {\n        console.log('Medical history table does not exist, skipping');\n      } else {\n        console.warn('Medical history table may not exist:', err);\n      }\n    }\n\n    // Fetch from patient_symptoms table (handle if table doesn't exist)\n    try {\n      const { data: symptomsData, error: symptomsError } = await supabase\n        .from('patient_symptoms')\n        .select('*')\n        .eq('patient_id', patientId);\n\n      if (symptomsError) {\n        if (symptomsError.code === '42P01') {\n          console.log('Patient symptoms table does not exist, skipping');\n        } else if (symptomsError.code !== 'PGRST116') {\n          console.error('Error fetching patient symptoms:', symptomsError);\n        }\n      } else if (symptomsData) {\n        symptomsData.forEach((item: any) => {\n          combinedHistory.push({\n            id: item.id,\n            patient_id: item.patient_id,\n            event_type: 'Symptom',\n            event_name: item.symptom_name,\n            event_date: item.recorded_at,\n            details: `Severity: ${item.severity}, Onset: ${item.onset_date}`,\n            doctor_name: null,\n            facility_name: null,\n            source: 'symptom' as const,\n          });\n        });\n      }\n    } catch (err: any) {\n      if (err.message?.includes('relation') && err.message?.includes('does not exist')) {\n        console.log('Patient symptoms table does not exist, skipping');\n      } else {\n        console.warn('Patient symptoms table may not exist:', err);\n      }\n    }\n\n    // Fetch from patient_allergies table (handle if table doesn't exist)\n    try {\n      const { data: allergiesData, error: allergiesError } = await supabase\n        .from('patient_allergies')\n        .select('*')\n        .eq('patient_id', patientId);\n\n      if (allergiesError) {\n        if (allergiesError.code === '42P01') {\n          console.log('Patient allergies table does not exist, skipping');\n        } else if (allergiesError.code !== 'PGRST116') {\n          console.error('Error fetching patient allergies:', allergiesError);\n        }\n      } else if (allergiesData) {\n        allergiesData.forEach((item: any) => {\n          combinedHistory.push({\n            id: item.id,\n            patient_id: item.patient_id,\n            event_type: 'Allergy',\n            event_name: item.allergen,\n            event_date: item.recorded_at,\n            details: `Reaction: ${item.reaction}, Severity: ${item.severity}`,\n            doctor_name: null,\n            facility_name: null,\n            source: 'allergy' as const,\n          });\n        });\n      }\n    } catch (err: any) {\n      if (err.message?.includes('relation') && err.message?.includes('does not exist')) {\n        console.log('Patient allergies table does not exist, skipping');\n      } else {\n        console.warn('Patient allergies table may not exist:', err);\n      }\n    }\n\n    // Sort by event date, most recent first\n    combinedHistory.sort((a, b) => new Date(b.event_date).getTime() - new Date(a.event_date).getTime());\n\n    return combinedHistory;\n\n  } catch (error) {\n    console.error('An unexpected error occurred while fetching medical history:', error);\n    return [];\n  }\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1257, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/components/MedicalHistoryForm.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { X } from 'lucide-react';\nimport { CreateMedicalHistoryInput, createMedicalHistory } from '../lib/medicalHistoryService';\n\ninterface MedicalHistoryFormProps {\n  patientId: string;\n  onClose: () => void;\n  onSuccess: () => void;\n}\n\nexport default function MedicalHistoryForm({ patientId, onClose, onSuccess }: MedicalHistoryFormProps) {\n  const [formData, setFormData] = useState<CreateMedicalHistoryInput>({\n    patientId,\n    eventType: '',\n    eventName: '',\n    eventDate: new Date().toISOString().split('T')[0],\n    details: '',\n    doctorName: '',\n    facilityName: ''\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleChange = (\n    e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>\n  ) => {\n    const { name, value } = e.target;\n    setFormData((prev) => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    try {\n      await createMedicalHistory(formData);\n      onSuccess();\n      onClose();\n    } catch (err) {\n      console.error('Error creating medical history:', err);\n      setError('Failed to create medical history entry. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-lg\">\n        <div className=\"flex justify-between items-center mb-4\">\n          <h3 className=\"text-lg font-medium text-gray-900\">Add Medical Event</h3>\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700\"\n          >\n            <X className=\"h-5 w-5\" />\n          </button>\n        </div>\n\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4\">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"eventType\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Event Type\n              </label>\n              <select\n                id=\"eventType\"\n                name=\"eventType\"\n                value={formData.eventType}\n                onChange={handleChange}\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                required\n              >\n                <option value=\"\">Select Event Type</option>\n                <option value=\"Diagnosis\">Diagnosis</option>\n                <option value=\"Surgery\">Surgery</option>\n                <option value=\"Vaccination\">Vaccination</option>\n                <option value=\"Medication\">Medication</option>\n                <option value=\"Test\">Test/Lab Result</option>\n                <option value=\"Procedure\">Procedure</option>\n                <option value=\"Visit\">Visit</option>\n                <option value=\"Other\">Other</option>\n              </select>\n            </div>\n            \n            <div>\n              <label htmlFor=\"eventName\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Event Name\n              </label>\n              <input\n                type=\"text\"\n                id=\"eventName\"\n                name=\"eventName\"\n                value={formData.eventName}\n                onChange={handleChange}\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                placeholder=\"e.g., Appendectomy, Flu Shot, etc.\"\n                required\n              />\n            </div>\n            \n            <div>\n              <label htmlFor=\"eventDate\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Date\n              </label>\n              <input\n                type=\"date\"\n                id=\"eventDate\"\n                name=\"eventDate\"\n                value={formData.eventDate}\n                onChange={handleChange}\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                required\n              />\n            </div>\n            \n            <div>\n              <label htmlFor=\"details\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Details\n              </label>\n              <textarea\n                id=\"details\"\n                name=\"details\"\n                value={formData.details || ''}\n                onChange={handleChange}\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                rows={3}\n                placeholder=\"Enter any relevant details about this medical event\"\n              />\n            </div>\n            \n            <div>\n              <label htmlFor=\"doctorName\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Doctor Name\n              </label>\n              <input\n                type=\"text\"\n                id=\"doctorName\"\n                name=\"doctorName\"\n                value={formData.doctorName || ''}\n                onChange={handleChange}\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                placeholder=\"Dr. Name (optional)\"\n              />\n            </div>\n            \n            <div>\n              <label htmlFor=\"facilityName\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Facility Name\n              </label>\n              <input\n                type=\"text\"\n                id=\"facilityName\"\n                name=\"facilityName\"\n                value={formData.facilityName || ''}\n                onChange={handleChange}\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500\"\n                placeholder=\"Hospital or clinic name (optional)\"\n              />\n            </div>\n            \n            <div className=\"flex justify-end gap-2 pt-4\">\n              <button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50\"\n                disabled={loading}\n              >\n                Cancel\n              </button>\n              <button\n                type=\"submit\"\n                className=\"px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 disabled:bg-orange-300\"\n                disabled={loading}\n              >\n                {loading ? 'Saving...' : 'Save Medical Event'}\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1674, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/components/AddDummyMedicalHistory.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { addDummyMedicalHistory } from '../lib/medicalHistoryService';\n\ninterface AddDummyMedicalHistoryProps {\n  patientId: string;\n  onSuccess: () => void;\n}\n\nexport default function AddDummyMedicalHistory({ patientId, onSuccess }: AddDummyMedicalHistoryProps) {\n  const [loading, setLoading] = useState(false);\n\n  const handleAddDummyData = async () => {\n    if (!patientId) return;\n    \n    setLoading(true);\n    try {\n      await addDummyMedicalHistory(patientId);\n      onSuccess();\n    } catch (error) {\n      console.error('Error adding dummy data:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <button\n      onClick={handleAddDummyData}\n      disabled={loading}\n      className=\"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:bg-blue-300\"\n    >\n      {loading ? 'Adding...' : 'Add Dummy Data'}\n    </button>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;;AAOe,SAAS,uBAAuB,EAAE,SAAS,EAAE,SAAS,EAA+B;;IAClG,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,MAAM,qBAAqB;QACzB,IAAI,CAAC,WAAW;QAEhB,WAAW;QACX,IAAI;YACF,MAAM,CAAA,GAAA,sIAAA,CAAA,yBAAsB,AAAD,EAAE;YAC7B;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;QAC5C,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,6LAAC;QACC,SAAS;QACT,UAAU;QACV,WAAU;kBAET,UAAU,cAAc;;;;;;AAG/B;GA1BwB;KAAA","debugId":null}},
    {"offset": {"line": 1723, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/app/patients/%5Bid%5D/page.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useEffect } from 'react';\nimport { \n  ArrowLeft, \n  Calendar, \n  File, \n  Pill, \n  Activity, \n  MessageSquare,\n  Edit,\n  Phone,\n  Mail,\n  MapPin,\n  Clock,\n  Plus,\n  AlertCircle,\n  FileText,\n  ChevronRight,\n  Heart,\n  Building,\n  User,\n  Users,\n  Shield,\n  Stethoscope,\n  ClipboardList,\n  Hash,\n  UserCheck,\n  Eye,\n  CheckCircle,\n  AlertTriangle,\n  X\n} from 'lucide-react';\nimport { getPatientWithRelatedData } from '../../../src/lib/patientService';\nimport { getPatientVitals, recordVitals, updateVitalRecord } from '../../../src/lib/vitalsService';\nimport { getMedicalHistory, MedicalHistoryEvent } from '../../../src/lib/medicalHistoryService';\nimport MedicalHistoryForm from '../../../src/components/MedicalHistoryForm';\nimport AddDummyMedicalHistory from '../../../src/components/AddDummyMedicalHistory';\nimport { getCurrentUser } from '../../../src/lib/supabase';\nimport Link from 'next/link';\nimport { useRouter } from 'next/navigation';\n\ninterface Patient {\n  id: string;\n  patient_id: string;\n  name: string;\n  date_of_birth: string;\n  gender: string;\n  phone: string;\n  email: string;\n  address: string;\n  blood_group: string;\n  allergies: string;\n  medical_history: string;\n  admission_date: string;\n  admission_time: string;\n  primary_complaint: string;\n  admission_type: string;\n  referring_doctor_facility: string;\n  department_ward: string;\n  room_number: string;\n  guardian_name: string;\n  guardian_relationship: string;\n  guardian_phone: string;\n  guardian_address: string;\n  emergency_contact_name: string;\n  emergency_contact_phone: string;\n  emergency_contact_relationship: string;\n  insurance_provider: string;\n  insurance_number: string;\n  initial_symptoms: string;\n  referred_by: string;\n  status: string;\n  created_at: string;\n  appointments: any[];\n  bed_allocations: any[];\n}\n\nexport default function PatientDetailsPage({ params }: { params: Promise<{ id: string }> }) {\n  // Unwrap the params Promise using React.use()\n  const unwrappedParams = React.use(params);\n  const router = useRouter();\n  const [patient, setPatient] = useState<Patient | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [activeTab, setActiveTab] = useState('overview');\n  const [vitals, setVitals] = useState<any[]>([]);\n  const [showVitalsForm, setShowVitalsForm] = useState(false);\n  const [editingVital, setEditingVital] = useState<any | null>(null);\n  const [currentUser, setCurrentUser] = useState<any | null>(null);\n  const [vitalsLoading, setVitalsLoading] = useState(false);\n  const [medicalHistory, setMedicalHistory] = useState<MedicalHistoryEvent[]>([]);\n  const [historyLoading, setHistoryLoading] = useState(false);\n  const [showMedicalHistoryForm, setShowMedicalHistoryForm] = useState(false);\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      const user = await getCurrentUser();\n      setCurrentUser(user);\n    };\n    fetchUser();\n  }, []);\n\n  useEffect(() => {\n    fetchPatientData();\n  }, [unwrappedParams.id]);\n\n  const fetchPatientData = async () => {\n    try {\n      setLoading(true);\n      const patientData = await getPatientWithRelatedData(unwrappedParams.id);\n      setPatient(patientData);\n      \n      // Fetch vitals data\n      setVitalsLoading(true);\n      try {\n        const vitalsData = await getPatientVitals(unwrappedParams.id);\n        setVitals(vitalsData);\n      } catch (vitalsError) {\n        console.error('Error fetching vitals data:', vitalsError);\n      } finally {\n        setVitalsLoading(false);\n      }\n\n      // Fetch medical history data\n      setHistoryLoading(true);\n      try {\n        const historyData = await getMedicalHistory(unwrappedParams.id);\n        setMedicalHistory(historyData);\n      } catch (historyError) {\n        console.error('Error fetching medical history data:', historyError);\n      } finally {\n        setHistoryLoading(false);\n      }\n    } catch (err) {\n      console.error('Error fetching patient data:', err);\n      setError(err instanceof Error ? err.message : 'Failed to load patient data');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const calculateAge = (dateOfBirth: string) => {\n    const birth = new Date(dateOfBirth);\n    const today = new Date();\n    let age = today.getFullYear() - birth.getFullYear();\n    const monthDiff = today.getMonth() - birth.getMonth();\n    \n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {\n      age--;\n    }\n    \n    return age;\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status?.toLowerCase()) {\n      case 'critical':\n        return 'text-red-500 bg-red-50 border-red-200';\n      case 'stable':\n        return 'text-green-500 bg-green-50 border-green-200';\n      case 'recovering':\n        return 'text-orange-500 bg-orange-50 border-orange-200';\n      case 'active':\n        return 'text-blue-500 bg-blue-50 border-blue-200';\n      default:\n        return 'text-gray-500 bg-gray-50 border-gray-200';\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    if (!dateString) return 'Not specified';\n    return new Date(dateString).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  const formatDateTime = (dateString: string) => {\n    if (!dateString) return 'Not specified';\n    return new Date(dateString).toLocaleString('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 border-4 border-orange-200 border-t-orange-500 rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading patient data...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <AlertCircle className=\"w-16 h-16 text-red-500 mx-auto mb-4\" />\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Error Loading Patient</h2>\n          <p className=\"text-gray-600 mb-4\">{error}</p>\n          <Link href=\"/patients\">\n            <button className=\"bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600 transition-colors\">\n              Back to Patients\n            </button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  if (!patient) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <User className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Patient Not Found</h2>\n          <p className=\"text-gray-600 mb-4\">The requested patient could not be found.</p>\n          <Link href=\"/patients\">\n            <button className=\"bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600 transition-colors\">\n              Back to Patients\n            </button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow-sm border-b border-gray-200\">\n        <div className=\"max-w-7xl mx-auto px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-4\">\n              <Link href=\"/patients\">\n                <button className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\">\n                  <ArrowLeft className=\"h-5 w-5 text-gray-600\" />\n                </button>\n              </Link>\n              <div>\n                <h1 className=\"text-2xl font-bold text-gray-900\">{patient.name}</h1>\n                <div className=\"flex items-center gap-4 mt-1\">\n                  <span className=\"text-lg font-mono text-orange-600\">{patient.patient_id}</span>\n                  <span className={`px-3 py-1 rounded-full text-xs font-medium border ${getStatusColor(patient.status)}`}>\n                    {patient.status?.charAt(0).toUpperCase() + patient.status?.slice(1) || 'Active'}\n                  </span>\n                </div>\n              </div>\n            </div>\n            <div className=\"flex gap-3\">\n              <button \n                onClick={() => router.push(`/patients/${patient.patient_id}/edit`)}\n                className=\"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2\"\n              >\n                <Edit className=\"h-4 w-4\" />\n                Edit Patient\n              </button>\n              <button className=\"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2\">\n                <Plus className=\"h-4 w-4\" />\n                New Appointment\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-6 py-6\">\n        {/* Patient Overview Cards */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6\">\n          {/* Personal Information Card */}\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"p-2 bg-blue-100 rounded-lg\">\n                <User className=\"h-5 w-5 text-blue-600\" />\n              </div>\n              <h3 className=\"font-semibold text-gray-900\">Personal Information</h3>\n            </div>\n            \n            <div className=\"space-y-3\">\n              <div className=\"flex items-center text-sm\">\n                <Calendar className=\"h-4 w-4 text-gray-400 mr-3\" />\n                <span className=\"text-gray-600\">Age:</span>\n                <span className=\"ml-2 font-medium\">{calculateAge(patient.date_of_birth)} years</span>\n              </div>\n              \n              <div className=\"flex items-center text-sm\">\n                <User className=\"h-4 w-4 text-gray-400 mr-3\" />\n                <span className=\"text-gray-600\">Gender:</span>\n                <span className=\"ml-2 font-medium capitalize\">{patient.gender}</span>\n              </div>\n              \n              <div className=\"flex items-center text-sm\">\n                <Phone className=\"h-4 w-4 text-gray-400 mr-3\" />\n                <span className=\"text-gray-600\">Phone:</span>\n                <span className=\"ml-2 font-medium\">{patient.phone}</span>\n              </div>\n              \n              <div className=\"flex items-center text-sm\">\n                <Mail className=\"h-4 w-4 text-gray-400 mr-3\" />\n                <span className=\"text-gray-600\">Email:</span>\n                <span className=\"ml-2 font-medium\">{patient.email}</span>\n              </div>\n              \n              <div className=\"flex items-start text-sm\">\n                <MapPin className=\"h-4 w-4 text-gray-400 mr-3 mt-0.5\" />\n                <div>\n                  <span className=\"text-gray-600\">Address:</span>\n                  <p className=\"ml-2 font-medium\">{patient.address}</p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Medical Information Card */}\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"p-2 bg-green-100 rounded-lg\">\n                <Heart className=\"h-5 w-5 text-green-600\" />\n              </div>\n              <h3 className=\"font-semibold text-gray-900\">Medical Information</h3>\n            </div>\n            \n            <div className=\"space-y-3\">\n              <div className=\"flex items-center text-sm\">\n                <Heart className=\"h-4 w-4 text-gray-400 mr-3\" />\n                <span className=\"text-gray-600\">Blood Group:</span>\n                <span className=\"ml-2 font-medium\">{patient.blood_group || 'Not specified'}</span>\n              </div>\n              \n              {patient.allergies && (\n                <div className=\"bg-red-50 p-3 rounded-lg border border-red-200\">\n                  <div className=\"flex items-center text-red-700 text-sm font-medium mb-1\">\n                    <AlertTriangle className=\"h-4 w-4 mr-2\" />\n                    Allergies\n                  </div>\n                  <p className=\"text-red-600 text-sm\">{patient.allergies}</p>\n                </div>\n              )}\n              \n              {patient.initial_symptoms && (\n                <div className=\"bg-yellow-50 p-3 rounded-lg border border-yellow-200\">\n                  <div className=\"flex items-center text-yellow-700 text-sm font-medium mb-1\">\n                    <Stethoscope className=\"h-4 w-4 mr-2\" />\n                    Initial Symptoms\n                  </div>\n                  <p className=\"text-yellow-600 text-sm\">{patient.initial_symptoms}</p>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Admission Information Card */}\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"p-2 bg-purple-100 rounded-lg\">\n                <Building className=\"h-5 w-5 text-purple-600\" />\n              </div>\n              <h3 className=\"font-semibold text-gray-900\">Admission Information</h3>\n            </div>\n            \n            <div className=\"space-y-3\">\n              {patient.admission_date && (\n                <div className=\"flex items-center text-sm\">\n                  <Clock className=\"h-4 w-4 text-gray-400 mr-3\" />\n                  <span className=\"text-gray-600\">Admitted:</span>\n                  <span className=\"ml-2 font-medium\">{formatDateTime(patient.admission_date)}</span>\n                </div>\n              )}\n              \n              {patient.admission_type && (\n                <div className=\"flex items-center text-sm\">\n                  <FileText className=\"h-4 w-4 text-gray-400 mr-3\" />\n                  <span className=\"text-gray-600\">Type:</span>\n                  <span className=\"ml-2 font-medium capitalize\">{patient.admission_type}</span>\n                </div>\n              )}\n              \n              {patient.department_ward && (\n                <div className=\"flex items-center text-sm\">\n                  <Building className=\"h-4 w-4 text-gray-400 mr-3\" />\n                  <span className=\"text-gray-600\">Department:</span>\n                  <span className=\"ml-2 font-medium\">{patient.department_ward}</span>\n                </div>\n              )}\n              \n              {patient.room_number && (\n                <div className=\"flex items-center text-sm\">\n                  <MapPin className=\"h-4 w-4 text-gray-400 mr-3\" />\n                  <span className=\"text-gray-600\">Room:</span>\n                  <span className=\"ml-2 font-medium\">{patient.room_number}</span>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Tabs Navigation */}\n        <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 mb-6\">\n          <div className=\"border-b border-gray-200\">\n            <nav className=\"flex space-x-8 px-6\">\n              {[\n                { id: 'overview', name: 'Overview', icon: Eye },\n                { id: 'vitals', name: 'Vitals', icon: Activity },\n                { id: 'medical-history', name: 'Medical History', icon: Heart },\n                { id: 'contacts', name: 'Contacts', icon: Users },\n                { id: 'appointments', name: 'Appointments', icon: Calendar },\n                { id: 'billing', name: 'Billing', icon: FileText }\n              ].map((tab) => (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id)}\n                  className={`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${\n                    activeTab === tab.id\n                      ? 'border-orange-500 text-orange-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                  }`}\n                >\n                  <tab.icon className=\"h-4 w-4\" />\n                  {tab.name}\n                </button>\n              ))}\n            </nav>\n          </div>\n\n          <div className=\"p-6\">\n            {/* Overview Tab */}\n            {activeTab === 'overview' && (\n              <div className=\"space-y-6\">\n                {patient.primary_complaint && (\n                  <div className=\"bg-orange-50 p-4 rounded-lg border border-orange-200\">\n                    <h4 className=\"font-medium text-orange-900 mb-2 flex items-center gap-2\">\n                      <ClipboardList className=\"h-4 w-4\" />\n                  Primary Complaint / Reason for Visit\n                    </h4>\n                    <p className=\"text-orange-800\">{patient.primary_complaint}</p>\n                  </div>\n                )}\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {patient.referring_doctor_facility && (\n                    <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\n                      <h4 className=\"font-medium text-blue-900 mb-2\">Referring Doctor/Facility</h4>\n                      <p className=\"text-blue-800\">{patient.referring_doctor_facility}</p>\n                    </div>\n                  )}\n\n                  {patient.referred_by && (\n                    <div className=\"bg-green-50 p-4 rounded-lg border border-green-200\">\n                      <h4 className=\"font-medium text-green-900 mb-2\">Referred By</h4>\n                      <p className=\"text-green-800\">{patient.referred_by}</p>\n                    </div>\n                  )}\n                </div>\n\n                {/* Recent Activity */}\n                <div>\n                  <h4 className=\"font-medium text-gray-900 mb-4\">Recent Activity</h4>\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\n                      <div className=\"w-2 h-2 bg-green-400 rounded-full mr-3\"></div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-sm text-gray-900\">Patient registered</p>\n                        <p className=\"text-xs text-gray-500\">{formatDateTime(patient.created_at)}</p>\n                      </div>\n                    </div>\n                    {patient.admission_date && (\n                      <div className=\"flex items-center p-3 bg-gray-50 rounded-lg\">\n                        <div className=\"w-2 h-2 bg-blue-400 rounded-full mr-3\"></div>\n                        <div className=\"flex-1\">\n                          <p className=\"text-sm text-gray-900\">Patient admitted</p>\n                          <p className=\"text-xs text-gray-500\">{formatDateTime(patient.admission_date)}</p>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Vitals Tab */}\n            {activeTab === 'vitals' && (\n              <div className=\"space-y-6\">\n                <div className=\"flex justify-between items-center\">\n                  <h3 className=\"text-lg font-medium text-gray-900\">Patient Vitals</h3>\n                  <button\n                    onClick={() => {\n                      setEditingVital(null);\n                      setShowVitalsForm(true);\n                    }}\n                    className=\"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2\"\n                  >\n                    <Plus className=\"h-4 w-4\" />\n                    Record New Vitals\n                  </button>\n                </div>\n\n                {vitalsLoading ? (\n                  <div className=\"flex justify-center items-center py-12\">\n                    <div className=\"w-8 h-8 border-4 border-orange-200 border-t-orange-500 rounded-full animate-spin\"></div>\n                  </div>\n                ) : vitals.length === 0 ? (\n                  <div className=\"text-center py-12 bg-gray-50 rounded-lg border border-gray-200\">\n                    <Activity className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                    <h4 className=\"text-lg font-medium text-gray-900 mb-2\">No vitals recorded</h4>\n                    <p className=\"text-gray-500 mb-4\">Get started by recording new vitals for this patient.</p>\n                    <button\n                      onClick={() => {\n                        setEditingVital(null);\n                        setShowVitalsForm(true);\n                      }}\n                      className=\"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors\"\n                    >\n                      Record First Vitals\n                    </button>\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {vitals.map((vital) => (\n                      <div key={vital.id} className=\"bg-white rounded-lg border border-gray-200 p-4\">\n                        <div className=\"flex justify-between items-start mb-3\">\n                          <div>\n                            <h4 className=\"font-medium text-gray-900\">\n                              Recorded on {new Date(vital.recorded_at).toLocaleString()}\n                            </h4>\n                            <p className=\"text-sm text-gray-500\">Recorded by: {vital.user?.name || 'Unknown'}</p>\n                          </div>\n                          <button\n                            onClick={() => {\n                              setEditingVital(vital);\n                              setShowVitalsForm(true);\n                            }}\n                            className=\"text-orange-500 hover:text-orange-700 text-sm font-medium\"\n                          >\n                            Edit\n                          </button>\n                        </div>\n                        \n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                          {vital.systolic_bp && vital.diastolic_bp && (\n                            <div className=\"bg-red-50 p-3 rounded-lg\">\n                              <p className=\"text-xs text-red-600 font-medium\">Blood Pressure</p>\n                              <p className=\"text-lg font-semibold text-red-800\">\n                                {vital.systolic_bp}/{vital.diastolic_bp}\n                              </p>\n                            </div>\n                          )}\n                          \n                          {vital.heart_rate && (\n                            <div className=\"bg-blue-50 p-3 rounded-lg\">\n                              <p className=\"text-xs text-blue-600 font-medium\">Heart Rate</p>\n                              <p className=\"text-lg font-semibold text-blue-800\">\n                                {vital.heart_rate} <span className=\"text-sm\">bpm</span>\n                              </p>\n                            </div>\n                          )}\n                          \n                          {vital.temperature && (\n                            <div className=\"bg-yellow-50 p-3 rounded-lg\">\n                              <p className=\"text-xs text-yellow-600 font-medium\">Temperature</p>\n                              <p className=\"text-lg font-semibold text-yellow-800\">\n                                {vital.temperature} <span className=\"text-sm\">C</span>\n                              </p>\n                            </div>\n                          )}\n                          \n                          {vital.oxygen_saturation && (\n                            <div className=\"bg-green-50 p-3 rounded-lg\">\n                              <p className=\"text-xs text-green-600 font-medium\">Oxygen Saturation</p>\n                              <p className=\"text-lg font-semibold text-green-800\">\n                                {vital.oxygen_saturation}%\n                              </p>\n                            </div>\n                          )}\n                          \n                          {vital.weight && (\n                            <div className=\"bg-purple-50 p-3 rounded-lg\">\n                              <p className=\"text-xs text-purple-600 font-medium\">Weight</p>\n                              <p className=\"text-lg font-semibold text-purple-800\">\n                                {vital.weight} <span className=\"text-sm\">kg</span>\n                              </p>\n                            </div>\n                          )}\n                          \n                          {vital.height && (\n                            <div className=\"bg-indigo-50 p-3 rounded-lg\">\n                              <p className=\"text-xs text-indigo-600 font-medium\">Height</p>\n                              <p className=\"text-lg font-semibold text-indigo-800\">\n                                {vital.height} <span className=\"text-sm\">cm</span>\n                              </p>\n                            </div>\n                          )}\n                          \n                          {vital.bmi && (\n                            <div className=\"bg-teal-50 p-3 rounded-lg\">\n                              <p className=\"text-xs text-teal-600 font-medium\">BMI</p>\n                              <p className=\"text-lg font-semibold text-teal-800\">{vital.bmi}</p>\n                            </div>\n                          )}\n                          \n                          {vital.blood_glucose && (\n                            <div className=\"bg-pink-50 p-3 rounded-lg\">\n                              <p className=\"text-xs text-pink-600 font-medium\">Blood Glucose</p>\n                              <p className=\"text-lg font-semibold text-pink-800\">\n                                {vital.blood_glucose} <span className=\"text-sm\">mg/dL</span>\n                              </p>\n                            </div>\n                          )}\n                          \n                          {vital.pain_scale !== undefined && vital.pain_scale !== null && (\n                            <div className=\"bg-orange-50 p-3 rounded-lg\">\n                              <p className=\"text-xs text-orange-600 font-medium\">Pain Scale</p>\n                              <p className=\"text-lg font-semibold text-orange-800\">\n                                {vital.pain_scale}/10\n                              </p>\n                            </div>\n                          )}\n                        </div>\n                        \n                        {vital.notes && (\n                          <div className=\"mt-3 pt-3 border-t border-gray-100\">\n                            <p className=\"text-sm text-gray-600\">\n                              <span className=\"font-medium\">Notes:</span> {vital.notes}\n                            </p>\n                          </div>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Medical History Tab */}\n            {activeTab === 'medical-history' && (\n              <div className=\"space-y-6\">\n                <div className=\"flex justify-between items-center\">\n                  <h3 className=\"text-lg font-medium text-gray-900\">Medical History Timeline</h3>\n                  <div className=\"flex gap-2\">\n                    <button\n                      onClick={() => setShowMedicalHistoryForm(true)}\n                      className=\"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2\"\n                    >\n                      <Plus className=\"h-4 w-4\" />\n                      Add Medical Event\n                    </button>\n                    {patient?.id && (\n                      <AddDummyMedicalHistory \n                        patientId={patient.id} \n                        onSuccess={async () => {\n                          setHistoryLoading(true);\n                          try {\n                            const historyData = await getMedicalHistory(patient.id);\n                            setMedicalHistory(historyData);\n                          } catch (error) {\n                            console.error('Error fetching medical history:', error);\n                          } finally {\n                            setHistoryLoading(false);\n                          }\n                        }} \n                      />\n                    )}\n                  </div>\n                </div>\n                \n                {historyLoading ? (\n                  <div className=\"flex justify-center items-center py-12\">\n                    <div className=\"w-8 h-8 border-4 border-orange-200 border-t-orange-500 rounded-full animate-spin\"></div>\n                  </div>\n                ) : medicalHistory.length === 0 ? (\n                  <div className=\"text-center py-12 bg-gray-50 rounded-lg border border-gray-200\">\n                    <Heart className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                    <h4 className=\"text-lg font-medium text-gray-900 mb-2\">No medical history found</h4>\n                    <p className=\"text-gray-500 mb-4\">No medical events have been recorded for this patient.</p>\n                    <button\n                      onClick={() => setShowMedicalHistoryForm(true)}\n                      className=\"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors\"\n                    >\n                      Record First Medical Event\n                    </button>\n                  </div>\n                ) : (\n                  <div className=\"space-y-6\">\n                    {medicalHistory.map((event) => (\n                      <div key={event.id} className=\"flex gap-4\">\n                        <div className=\"flex flex-col items-center\">\n                          <div className=\"w-4 h-4 bg-orange-500 rounded-full\"></div>\n                          <div className=\"w-px h-full bg-gray-300\"></div>\n                        </div>\n                        <div className=\"flex-1\">\n                          <p className=\"font-semibold text-gray-700\">{event.event_name}</p>\n                          <p className=\"text-sm text-gray-500\">{new Date(event.event_date).toLocaleDateString()} - {event.event_type}</p>\n                          <p className=\"text-sm text-gray-600 mt-1\">{event.details}</p>\n                          {event.doctor_name && <p className=\"text-sm text-blue-600 mt-1\">Doctor: {event.doctor_name}</p>}\n                          {event.facility_name && <p className=\"text-sm text-purple-600 mt-1\">Facility: {event.facility_name}</p>}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n                \n                {/* Medical History Form Modal */}\n                {showMedicalHistoryForm && patient?.id && (\n                  <MedicalHistoryForm\n                    patientId={patient.id}\n                    onClose={() => setShowMedicalHistoryForm(false)}\n                    onSuccess={async () => {\n                      setHistoryLoading(true);\n                      try {\n                        const historyData = await getMedicalHistory(patient.id);\n                        setMedicalHistory(historyData);\n                      } catch (error) {\n                        console.error('Error fetching medical history:', error);\n                      } finally {\n                        setHistoryLoading(false);\n                      }\n                    }}\n                  />\n                )}\n              </div>\n            )}\n\n            {/* Contacts Tab */}\n            {activeTab === 'contacts' && (\n              <div className=\"space-y-6\">\n                {/* Guardian Information */}\n                {(patient.guardian_name || patient.guardian_phone) && (\n                  <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\n                    <h4 className=\"font-medium text-purple-900 mb-3 flex items-center gap-2\">\n                      <UserCheck className=\"h-4 w-4\" />\n                      Guardian / Attendant Information\n                    </h4>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {patient.guardian_name && (\n                        <div>\n                          <span className=\"text-sm text-purple-700 font-medium\">Name:</span>\n                          <p className=\"text-purple-800\">{patient.guardian_name}</p>\n                        </div>\n                      )}\n                      {patient.guardian_relationship && (\n                        <div>\n                          <span className=\"text-sm text-purple-700 font-medium\">Relationship:</span>\n                          <p className=\"text-purple-800 capitalize\">{patient.guardian_relationship}</p>\n                        </div>\n                      )}\n                      {patient.guardian_phone && (\n                        <div>\n                          <span className=\"text-sm text-purple-700 font-medium\">Phone:</span>\n                          <p className=\"text-purple-800\">{patient.guardian_phone}</p>\n                        </div>\n                      )}\n                      {patient.guardian_address && (\n                        <div className=\"md:col-span-2\">\n                          <span className=\"text-sm text-purple-700 font-medium\">Address:</span>\n                          <p className=\"text-purple-800\">{patient.guardian_address}</p>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n                {/* Emergency Contact */}\n                {(patient.emergency_contact_name || patient.emergency_contact_phone) && (\n                  <div className=\"bg-red-50 p-4 rounded-lg border border-red-200\">\n                    <h4 className=\"font-medium text-red-900 mb-3 flex items-center gap-2\">\n                      <AlertTriangle className=\"h-4 w-4\" />\n                      Emergency Contact Information\n                    </h4>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {patient.emergency_contact_name && (\n                        <div>\n                          <span className=\"text-sm text-red-700 font-medium\">Name:</span>\n                          <p className=\"text-red-800\">{patient.emergency_contact_name}</p>\n                        </div>\n                      )}\n                      {patient.emergency_contact_relationship && (\n                        <div>\n                          <span className=\"text-sm text-red-700 font-medium\">Relationship:</span>\n                          <p className=\"text-red-800 capitalize\">{patient.emergency_contact_relationship}</p>\n                        </div>\n                      )}\n                      {patient.emergency_contact_phone && (\n                        <div className=\"md:col-span-2\">\n                          <span className=\"text-sm text-red-700 font-medium\">Phone:</span>\n                          <p className=\"text-red-800\">{patient.emergency_contact_phone}</p>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n                {/* Insurance Information */}\n                {(patient.insurance_provider || patient.insurance_number) && (\n                  <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\n                    <h4 className=\"font-medium text-blue-900 mb-3 flex items-center gap-2\">\n                      <Shield className=\"h-4 w-4\" />\n                      Insurance Information\n                    </h4>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {patient.insurance_provider && (\n                        <div>\n                          <span className=\"text-sm text-blue-700 font-medium\">Provider:</span>\n                          <p className=\"text-blue-800\">{patient.insurance_provider}</p>\n                        </div>\n                      )}\n                      {patient.insurance_number && (\n                        <div>\n                          <span className=\"text-sm text-blue-700 font-medium\">Policy Number:</span>\n                          <p className=\"text-blue-800\">{patient.insurance_number}</p>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Appointments Tab */}\n            {activeTab === 'appointments' && (\n              <div className=\"space-y-4\">\n                <div className=\"flex justify-between items-center\">\n                  <h4 className=\"font-medium text-gray-900\">Appointment History</h4>\n                  <button className=\"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2\">\n                    <Plus className=\"h-4 w-4\" />\n                    New Appointment\n                  </button>\n                </div>\n\n                {patient.appointments && patient.appointments.length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {patient.appointments.map((appointment, index) => (\n                      <div key={index} className=\"bg-gray-50 p-4 rounded-lg border border-gray-200\">\n                        <div className=\"flex justify-between items-start\">\n                          <div>\n                            <p className=\"font-medium text-gray-900\">{appointment.type}</p>\n                            <p className=\"text-sm text-gray-600\">\n                              {formatDate(appointment.appointment_date)} at {appointment.appointment_time}\n                            </p>\n                            {appointment.doctor && (\n                              <p className=\"text-sm text-gray-600\">\n                                Dr. {appointment.doctor.user?.name || 'Unknown'} - {appointment.doctor.user?.specialization || 'General'}\n                              </p>\n                            )}\n                            {appointment.symptoms && (\n                              <p className=\"text-sm text-gray-500 mt-1\">Symptoms: {appointment.symptoms}</p>\n                            )}\n                          </div>\n                          <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                            appointment.status === 'completed' ? 'bg-green-100 text-green-800' :\n                            appointment.status === 'scheduled' ? 'bg-blue-100 text-blue-800' :\n                            'bg-gray-100 text-gray-800'\n                          }`}>\n                            {appointment.status}\n                          </span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <Calendar className=\"h-12 w-12 text-gray-400 mx-auto mb-3\" />\n                    <p className=\"text-gray-500\">No appointments found</p>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Billing Tab */}\n            {activeTab === 'billing' && (\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium text-gray-900\">Billing Information</h4>\n                <div className=\"text-center py-8\">\n                  <FileText className=\"h-12 w-12 text-gray-400 mx-auto mb-3\" />\n                  <p className=\"text-gray-500\">Billing information will be available soon</p>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n      {showVitalsForm && patient && (\n        <VitalsForm\n          patientId={patient.patient_id}\n          onClose={() => {\n            setShowVitalsForm(false);\n            setEditingVital(null);\n          }}\n          onVitalsRecorded={() => {\n            // Refresh vitals data\n            fetchPatientData();\n          }}\n          editingVital={editingVital}\n          currentUser={currentUser}\n        />\n      )}\n    </div>\n  );\n}\n\n// Vitals Form Component\nfunction VitalsForm({ \n  patientId, \n  onClose, \n  onVitalsRecorded, \n  editingVital, \n  currentUser \n}: { \n  patientId: string; \n  onClose: () => void; \n  onVitalsRecorded: () => void; \n  editingVital: any | null;\n  currentUser: any | null;\n}) {\n  const [formData, setFormData] = useState({\n    systolicBp: '',\n    diastolicBp: '',\n    heartRate: '',\n    temperature: '',\n    respiratoryRate: '',\n    oxygenSaturation: '',\n    weight: '',\n    height: '',\n    bloodGlucose: '',\n    painScale: '',\n    notes: ''\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Initialize form with existing data when editing\n  useEffect(() => {\n    if (editingVital) {\n      setFormData({\n        systolicBp: editingVital.systolic_bp || '',\n        diastolicBp: editingVital.diastolic_bp || '',\n        heartRate: editingVital.heart_rate || '',\n        temperature: editingVital.temperature || '',\n        respiratoryRate: editingVital.respiratory_rate || '',\n        oxygenSaturation: editingVital.oxygen_saturation || '',\n        weight: editingVital.weight || '',\n        height: editingVital.height || '',\n        bloodGlucose: editingVital.blood_glucose || '',\n        painScale: editingVital.pain_scale !== undefined && editingVital.pain_scale !== null ? editingVital.pain_scale.toString() : '',\n        notes: editingVital.notes || ''\n      });\n    }\n  }, [editingVital]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    try {\n      const vitalsData: any = {\n        patientId,\n        recordedBy: currentUser?.id || null,\n        systolicBp: formData.systolicBp ? parseInt(formData.systolicBp) : undefined,\n        diastolicBp: formData.diastolicBp ? parseInt(formData.diastolicBp) : undefined,\n        heartRate: formData.heartRate ? parseInt(formData.heartRate) : undefined,\n        temperature: formData.temperature ? parseFloat(formData.temperature) : undefined,\n        respiratoryRate: formData.respiratoryRate ? parseInt(formData.respiratoryRate) : undefined,\n        oxygenSaturation: formData.oxygenSaturation ? parseInt(formData.oxygenSaturation) : undefined,\n        weight: formData.weight ? parseFloat(formData.weight) : undefined,\n        height: formData.height ? parseFloat(formData.height) : undefined,\n        bloodGlucose: formData.bloodGlucose ? parseInt(formData.bloodGlucose) : undefined,\n        painScale: formData.painScale ? parseInt(formData.painScale) : undefined,\n        notes: formData.notes || undefined\n      };\n\n      if (editingVital) {\n        // Update existing vital record\n        await updateVitalRecord(editingVital.id, vitalsData);\n      } else {\n        // Record new vital signs\n        await recordVitals(vitalsData);\n      }\n\n      onVitalsRecorded();\n      onClose();\n    } catch (err) {\n      console.error('Error recording vitals:', err);\n      setError(err instanceof Error ? err.message : 'Failed to record vitals');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n        <div className=\"p-6\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h2 className=\"text-xl font-bold text-gray-900\">\n              {editingVital ? 'Edit Vitals' : 'Record New Vitals'}\n            </h2>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600\"\n            >\n              <X className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {error && (\n            <div className=\"mb-4 p-3 bg-red-50 text-red-700 rounded-lg text-sm\">\n              {error}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            {/* Blood Pressure */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Systolic BP (mmHg)\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"systolicBp\"\n                  value={formData.systolicBp}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Diastolic BP (mmHg)\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"diastolicBp\"\n                  value={formData.diastolicBp}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n            </div>\n\n            {/* Vital Signs */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Heart Rate (bpm)\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"heartRate\"\n                  value={formData.heartRate}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Temperature (C)\n                </label>\n                <input\n                  type=\"number\"\n                  step=\"0.1\"\n                  name=\"temperature\"\n                  value={formData.temperature}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Respiratory Rate (bpm)\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"respiratoryRate\"\n                  value={formData.respiratoryRate}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Oxygen Saturation (%)\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"oxygenSaturation\"\n                  value={formData.oxygenSaturation}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n            </div>\n\n            {/* Physical Measurements */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Weight (kg)\n                </label>\n                <input\n                  type=\"number\"\n                  step=\"0.1\"\n                  name=\"weight\"\n                  value={formData.weight}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Height (cm)\n                </label>\n                <input\n                  type=\"number\"\n                  step=\"0.1\"\n                  name=\"height\"\n                  value={formData.height}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Blood Glucose (mg/dL)\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"bloodGlucose\"\n                  value={formData.bloodGlucose}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Pain Scale (0-10)\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  max=\"10\"\n                  name=\"painScale\"\n                  value={formData.painScale}\n                  onChange={handleChange}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                />\n              </div>\n            </div>\n\n            {/* Notes */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Notes\n              </label>\n              <textarea\n                name=\"notes\"\n                value={formData.notes}\n                onChange={handleChange}\n                rows={3}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\n                placeholder=\"Additional notes about the patient's condition...\"\n              />\n            </div>\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n              <button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50\"\n                disabled={loading}\n              >\n                Cancel\n              </button>\n              <button\n                type=\"submit\"\n                className=\"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:opacity-50\"\n                disabled={loading}\n              >\n                {loading ? 'Saving...' : editingVital ? 'Update Vitals' : 'Record Vitals'}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}