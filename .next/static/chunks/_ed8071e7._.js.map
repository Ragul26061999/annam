{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = 'https://zusheijhebsmjiyyeiqq.supabase.co';\nconst supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp1c2hlaWpoZWJzbWppeXllaXFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4MjI0NDAsImV4cCI6MjA2NzM5ODQ0MH0.iwGPaOJPa6OvwX_iA1xvRt5cM72DWfd8Br1pwRTemRc';\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n\nexport const signInWithEmail = async (email: string, password: string) => {\n  const { data, error } = await supabase.auth.signInWithPassword({\n    email,\n    password,\n  });\n  return { data, error };\n};\n\nexport const signUpWithEmail = async (email: string, password: string) => {\n  const { data, error } = await supabase.auth.signUp({\n    email,\n    password,\n    options: {\n      emailRedirectTo: `${window.location.origin}/auth/callback`,\n    },\n  });\n  return { data, error };\n};\n\n// Function to create admin user without email confirmation\nexport const createAdminUser = async (email: string, password: string) => {\n  const { data, error } = await supabase.auth.signUp({\n    email,\n    password,\n    options: {\n      emailRedirectTo: `${window.location.origin}/auth/callback`,\n      data: {\n        email_confirm: true,\n      },\n    },\n  });\n  return { data, error };\n};\n\nexport const signOut = async () => {\n  await supabase.auth.signOut();\n};\n\nexport const getCurrentUser = async () => {\n  const { data: { user } } = await supabase.auth.getUser();\n  return user;\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,cAAc;AACpB,MAAM,kBAAkB;AAEjB,MAAM,WAAW,CAAA,GAAA,0LAAA,CAAA,eAAY,AAAD,EAAE,aAAa;AAE3C,MAAM,kBAAkB,OAAO,OAAe;IACnD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,kBAAkB,CAAC;QAC7D;QACA;IACF;IACA,OAAO;QAAE;QAAM;IAAM;AACvB;AAEO,MAAM,kBAAkB,OAAO,OAAe;IACnD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,MAAM,CAAC;QACjD;QACA;QACA,SAAS;YACP,iBAAiB,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,cAAc,CAAC;QAC5D;IACF;IACA,OAAO;QAAE;QAAM;IAAM;AACvB;AAGO,MAAM,kBAAkB,OAAO,OAAe;IACnD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,MAAM,CAAC;QACjD;QACA;QACA,SAAS;YACP,iBAAiB,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,cAAc,CAAC;YAC1D,MAAM;gBACJ,eAAe;YACjB;QACF;IACF;IACA,OAAO;QAAE;QAAM;IAAM;AACvB;AAEO,MAAM,UAAU;IACrB,MAAM,SAAS,IAAI,CAAC,OAAO;AAC7B;AAEO,MAAM,iBAAiB;IAC5B,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IACtD,OAAO;AACT","debugId":null}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/barcodeUtils.ts"],"sourcesContent":["import { supabase } from './supabase';\n\n/**\n * Generate a barcode ID for a patient\n * Format: BARS{Year}{Month}{RandomDigits}\n * Example: BARS2025010001\n */\nexport function generateBarcodeId(uhid: string): string {\n  const now = new Date();\n  const year = now.getFullYear().toString();\n  const month = (now.getMonth() + 1).toString().padStart(2, '0');\n  \n  // Use UHID as base and add timestamp for uniqueness\n  const timestamp = now.getTime().toString().slice(-4); // Last 4 digits of timestamp\n  \n  return `BARS${year}${month}${timestamp}`;\n}\n\n/**\n * Generate SVG barcode using Code-128 format\n * This is a simplified implementation - in production, you'd use a proper barcode library\n */\nexport function generateBarcodeSVG(barcodeId: string): string {\n  const width = 300;\n  const height = 80;\n  const barWidth = 2;\n  const barsCount = barcodeId.length * 6; // Approximate for Code-128\n  \n  let svg = `<svg width=\"${width}\" height=\"${height}\" xmlns=\"http://www.w3.org/2000/svg\">`;\n  \n  // Background\n  svg += `<rect width=\"${width}\" height=\"${height}\" fill=\"white\"/>`;\n  \n  // Generate bars pattern (simplified)\n  let x = 10;\n  for (let i = 0; i < barcodeId.length; i++) {\n    const char = barcodeId[i];\n    const charCode = char.charCodeAt(0);\n    \n    // Create alternating pattern based on character\n    for (let j = 0; j < 6; j++) {\n      if ((charCode + j) % 2 === 0) {\n        svg += `<rect x=\"${x}\" y=\"10\" width=\"${barWidth}\" height=\"50\" fill=\"black\"/>`;\n      }\n      x += barWidth;\n    }\n  }\n  \n  // Add text below barcode\n  svg += `<text x=\"${width/2}\" y=\"${height-10}\" text-anchor=\"middle\" font-family=\"monospace\" font-size=\"12\" fill=\"black\">${barcodeId}</text>`;\n  \n  svg += '</svg>';\n  \n  return svg;\n}\n\n/**\n * Generate a more realistic barcode pattern\n * This creates a pattern that looks more like a real barcode\n */\nexport function generateRealisticBarcodeSVG(barcodeId: string): string {\n  const width = 300;\n  const height = 80;\n  const minBarWidth = 1;\n  const maxBarWidth = 4;\n  \n  let svg = `<svg width=\"${width}\" height=\"${height}\" xmlns=\"http://www.w3.org/2000/svg\">`;\n  \n  // Background\n  svg += `<rect width=\"${width}\" height=\"${height}\" fill=\"white\"/>`;\n  \n  // Generate more realistic bar pattern\n  let x = 20;\n  let isBlack = true;\n  \n  // Start and end patterns\n  const startPattern = [1, 1, 1, 1, 1, 1];\n  const endPattern = [1, 1, 1, 1, 1, 1];\n  \n  // Draw start pattern\n  for (const barWidth of startPattern) {\n    if (isBlack) {\n      svg += `<rect x=\"${x}\" y=\"10\" width=\"${barWidth}\" height=\"50\" fill=\"black\"/>`;\n    }\n    x += barWidth;\n    isBlack = !isBlack;\n  }\n  \n  // Draw data pattern\n  for (let i = 0; i < barcodeId.length; i++) {\n    const char = barcodeId[i];\n    const charCode = char.charCodeAt(0);\n    \n    // Create pattern based on character\n    const pattern = [];\n    for (let j = 0; j < 6; j++) {\n      const width = minBarWidth + ((charCode + j) % (maxBarWidth - minBarWidth + 1));\n      pattern.push(width);\n    }\n    \n    for (const barWidth of pattern) {\n      if (isBlack) {\n        svg += `<rect x=\"${x}\" y=\"10\" width=\"${barWidth}\" height=\"50\" fill=\"black\"/>`;\n      }\n      x += barWidth;\n      isBlack = !isBlack;\n    }\n  }\n  \n  // Draw end pattern\n  for (const barWidth of endPattern) {\n    if (isBlack) {\n      svg += `<rect x=\"${x}\" y=\"10\" width=\"${barWidth}\" height=\"50\" fill=\"black\"/>`;\n    }\n    x += barWidth;\n    isBlack = !isBlack;\n  }\n  \n  // Add text below barcode\n  svg += `<text x=\"${width/2}\" y=\"${height-10}\" text-anchor=\"middle\" font-family=\"monospace\" font-size=\"12\" fill=\"black\">${barcodeId}</text>`;\n  \n  svg += '</svg>';\n  \n  return svg;\n}\n\n/**\n * Update patient with barcode ID\n */\nexport async function updatePatientWithBarcode(patientId: string, barcodeId: string): Promise<void> {\n  try {\n    const { error } = await supabase\n      .from('patients')\n      .update({ barcode_id: barcodeId })\n      .eq('patient_id', patientId);\n    \n    if (error) {\n      console.error('Error updating patient with barcode:', error);\n      throw new Error(`Failed to update patient with barcode: ${error.message}`);\n    }\n  } catch (error) {\n    console.error('Error updating patient with barcode:', error);\n    throw error;\n  }\n}\n\n/**\n * Get patient by barcode ID\n */\nexport async function getPatientByBarcodeId(barcodeId: string): Promise<any> {\n  try {\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .select('*')\n      .eq('barcode_id', barcodeId)\n      .single();\n    \n    if (error) {\n      console.error('Error fetching patient by barcode:', error);\n      throw new Error(`Patient not found: ${error.message}`);\n    }\n    \n    return patient;\n  } catch (error) {\n    console.error('Error fetching patient by barcode:', error);\n    throw error;\n  }\n}\n\n/**\n * Generate printable barcode data\n */\nexport function generatePrintableBarcodeData(uhid: string, barcodeId: string, patientName: string): string {\n  const svg = generateRealisticBarcodeSVG(barcodeId);\n  \n  return `\n    <div style=\"width: 4in; height: 2in; padding: 0.2in; font-family: Arial, sans-serif; border: 1px solid #ccc; margin: 0.1in;\">\n      <div style=\"text-align: center; margin-bottom: 0.1in;\">\n        <h3 style=\"margin: 0; font-size: 14px; color: #333;\">ANNAM HOSPITAL</h3>\n        <p style=\"margin: 0; font-size: 10px; color: #666;\">Patient ID Card</p>\n      </div>\n      <div style=\"text-align: center; margin-bottom: 0.1in;\">\n        ${svg}\n      </div>\n      <div style=\"text-align: center; font-size: 12px;\">\n        <p style=\"margin: 0; font-weight: bold;\">${patientName}</p>\n        <p style=\"margin: 0; font-size: 10px; color: #666;\">UHID: ${uhid}</p>\n      </div>\n    </div>\n  `;\n}\n\n/**\n * Validate barcode ID format\n */\nexport function validateBarcodeId(barcodeId: string): boolean {\n  // Check if it matches the format: BARS{Year}{Month}{4digits}\n  const barcodeRegex = /^BARS\\d{4}(0[1-9]|1[0-2])\\d{4}$/;\n  return barcodeRegex.test(barcodeId);\n}\n\n/**\n * Extract information from barcode ID\n */\nexport function extractBarcodeInfo(barcodeId: string): {\n  year: string;\n  month: string;\n  sequence: string;\n} | null {\n  if (!validateBarcodeId(barcodeId)) {\n    return null;\n  }\n  \n  const year = barcodeId.substring(4, 8);\n  const month = barcodeId.substring(8, 10);\n  const sequence = barcodeId.substring(10, 14);\n  \n  return { year, month, sequence };\n}\n\n/**\n * Generate barcode for existing patient\n */\nexport async function generateBarcodeForPatient(patientId: string): Promise<string> {\n  try {\n    // Check if patient already has a barcode\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .select('barcode_id, patient_id')\n      .eq('patient_id', patientId)\n      .single();\n    \n    if (error) {\n      throw new Error(`Patient not found: ${error.message}`);\n    }\n    \n    // If patient already has a barcode, return it\n    if (patient.barcode_id && patient.barcode_id.trim() !== '') {\n      return patient.barcode_id;\n    }\n    \n    // Generate new barcode\n    const barcodeId = generateBarcodeId(patientId);\n    \n    // Update patient with barcode\n    await updatePatientWithBarcode(patientId, barcodeId);\n    \n    return barcodeId;\n  } catch (error) {\n    console.error('Error generating barcode for patient:', error);\n    throw error;\n  }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 282, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/patientService.ts"],"sourcesContent":["import { supabase } from './supabase';\nimport { generateBarcodeId, updatePatientWithBarcode } from './barcodeUtils';\n\n// Types - Updated to match comprehensive registration form\nexport interface PatientRegistrationData {\n  // Personal Information (Mandatory)\n  firstName: string;\n  lastName: string;\n  dateOfBirth: string;\n  gender: string;\n  maritalStatus?: string; // single, married, divorced, widowed, separated\n  phone: string;\n  email?: string;\n  address: string;\n  \n  // Medical & Admission Information \n  bloodGroup: string;\n  allergies: string;\n  medicalHistory: string;\n  currentMedications: string;\n  chronicConditions: string;\n  previousSurgeries: string;\n  \n  // Admission Details\n  admissionDate?: string;\n  admissionTime?: string;\n  primaryComplaint: string;\n  admissionType: string; // emergency, elective, referred\n  referringDoctorFacility?: string;\n  consultingDoctorId?: string;\n  consultingDoctorName?: string;\n  departmentWard?: string;\n  roomNumber?: string;\n  \n  // Guardian/Attendant Details (Optional)\n  guardianName?: string;\n  guardianRelationship?: string;\n  guardianPhone?: string;\n  guardianAddress?: string;\n  \n  // Emergency Contact (Optional)\n  emergencyContactName?: string;\n  emergencyContactPhone?: string;\n  emergencyContactRelationship?: string;\n  \n  // Insurance Information (Optional)\n  insuranceProvider?: string;\n  insuranceNumber?: string;\n  \n  // Initial Visit Information\n  initialSymptoms?: string;\n  referredBy?: string;\n}\n\nexport interface PatientResponse {\n  success: boolean;\n  patient?: any;\n  uhid?: string;\n  credentials?: {\n    email: string;\n    password: string;\n  };\n  error?: string;\n}\n\n/**\n * Generate a unique UHID (Unique Hospital ID) for a new patient\n * Format: UHID + current year + 6-digit sequential number\n * Example: UHID2025000001\n */\nexport async function generateUHID(): Promise<string> {\n  const now = new Date();\n  const yearTwoDigits = now.getFullYear().toString().slice(-2); // Last two digits of year\n  const month = (now.getMonth() + 1).toString().padStart(2, '0'); // Month with leading zero\n  \n  try {\n    // Generate a unique 4-digit random number\n    let uhid: string = '';\n    let isUnique = false;\n    let attempts = 0;\n    const maxAttempts = 1000;\n    \n    while (!isUnique && attempts < maxAttempts) {\n      // Generate 4-digit random number\n      const randomNumber = Math.floor(Math.random() * 10000).toString().padStart(4, '0');\n      uhid = `AH${yearTwoDigits}${month}${randomNumber}`;\n      \n      // Check if this UHID already exists\n      const { data: existing, error } = await supabase\n        .from('patients')\n        .select('patient_id')\n        .eq('patient_id', uhid)\n        .single();\n      \n      if (error && error.code === 'PGRST116') {\n        // No record found, UHID is unique\n        isUnique = true;\n      } else if (error) {\n        console.error('Error checking UHID uniqueness:', error);\n        throw new Error('Failed to generate UHID');\n      }\n      \n      attempts++;\n    }\n    \n    if (!isUnique) {\n      throw new Error('Failed to generate unique UHID after maximum attempts');\n    }\n    \n    return uhid;\n  } catch (error) {\n    console.error('Error generating UHID:', error);\n    throw new Error('Failed to generate UHID');\n  }\n}\n\n/**\n * Create authentication credentials for a new patient\n * Email format: UHID@annam.com\n * Password: \"password\" (as specified in requirements)\n */\nexport async function createPatientAuthCredentials(uhid: string): Promise<{ \n  authUser: any; \n  credentials: { email: string; password: string } \n}> {\n  const email = `${uhid}@annam.com`;\n  const password = 'password';\n\n  try {\n    // Create auth user using Supabase Admin API\n    const { data: authUser, error: authError } = await supabase.auth.signUp({\n      email,\n      password,\n      options: {\n        emailRedirectTo: `${window.location.origin}/auth/callback`,\n        data: {\n          role: 'patient',\n          uhid: uhid,\n          email_confirm: true\n        }\n      }\n    });\n\n    if (authError) {\n      console.error('Error creating auth user:', authError);\n      throw new Error(`Failed to create authentication: ${authError.message}`);\n    }\n\n    return {\n      authUser: authUser.user,\n      credentials: { email, password }\n    };\n  } catch (error) {\n    console.error('Error creating patient auth credentials:', error);\n    throw error;\n  }\n}\n\n/**\n * Insert comprehensive patient record into the patients table with all new fields\n */\nexport async function insertPatientRecord(\n  uhid: string, \n  registrationData: PatientRegistrationData,\n  userId?: string\n): Promise<any> {\n  try {\n    const fullName = `${registrationData.firstName} ${registrationData.lastName}`;\n    \n    // Generate barcode ID\n    const barcodeId = generateBarcodeId(uhid);\n    \n    // Prepare admission date and time\n    let admissionDateTime = null;\n    if (registrationData.admissionDate) {\n      if (registrationData.admissionTime) {\n        admissionDateTime = `${registrationData.admissionDate}T${registrationData.admissionTime}`;\n      } else {\n        admissionDateTime = `${registrationData.admissionDate}T00:00:00`;\n      }\n    }\n    \n    const patientData = {\n      // Basic Information\n      patient_id: uhid,\n      barcode_id: barcodeId, // Add barcode ID\n      name: fullName,\n      date_of_birth: registrationData.dateOfBirth,\n      gender: registrationData.gender.toLowerCase(),\n      marital_status: registrationData.maritalStatus || null,\n      phone: registrationData.phone,\n      email: registrationData.email || `${uhid}@annam.com`,\n      address: registrationData.address,\n      \n      // Medical Information\n      blood_group: registrationData.bloodGroup || null,\n      allergies: registrationData.allergies || null,\n      medical_history: registrationData.medicalHistory || null,\n      current_medications: registrationData.currentMedications || null,\n      chronic_conditions: registrationData.chronicConditions || null,\n      previous_surgeries: registrationData.previousSurgeries || null,\n      \n      // New Admission Information\n      admission_date: admissionDateTime,\n      admission_time: registrationData.admissionTime || null,\n      primary_complaint: registrationData.primaryComplaint,\n      admission_type: registrationData.admissionType,\n      referring_doctor_facility: registrationData.referringDoctorFacility || null,\n      department_ward: registrationData.departmentWard || null,\n      room_number: registrationData.roomNumber || null,\n      \n      // Guardian/Attendant Details (Optional)\n      guardian_name: registrationData.guardianName || null,\n      guardian_relationship: registrationData.guardianRelationship || null,\n      guardian_phone: registrationData.guardianPhone || null,\n      guardian_address: registrationData.guardianAddress || null,\n      \n      // Emergency Contact (Optional)\n      emergency_contact_name: registrationData.emergencyContactName || null,\n      emergency_contact_phone: registrationData.emergencyContactPhone || null,\n      emergency_contact_relationship: registrationData.emergencyContactRelationship || null,\n      \n      // Insurance Information\n      insurance_number: registrationData.insuranceNumber || null,\n      insurance_provider: registrationData.insuranceProvider || null,\n      \n      // Additional fields\n      initial_symptoms: registrationData.initialSymptoms || null,\n      referred_by: registrationData.referredBy || null,\n      \n      // Link to users table\n      user_id: userId || null,\n      \n      // System fields\n      status: 'active'\n    };\n\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .insert([patientData])\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error inserting patient record:', error);\n      throw new Error(`Failed to create patient record: ${error.message}`);\n    }\n\n    return patient;\n  } catch (error) {\n    console.error('Error inserting patient record:', error);\n    throw error;\n  }\n}\n\n/**\n * Link the Supabase auth user to the users table for role management\n */\nexport async function linkAuthUserToPatient(\n  authUserId: string, \n  uhid: string, \n  registrationData: PatientRegistrationData\n): Promise<any> {\n  try {\n    const fullName = `${registrationData.firstName} ${registrationData.lastName}`;\n    \n    const userData = {\n      auth_id: authUserId,\n      employee_id: uhid, // Using UHID as employee_id for patients\n      name: fullName,\n      email: registrationData.email || `${uhid}@annam.com`,\n      role: 'patient',\n      phone: registrationData.phone,\n      address: registrationData.address,\n      status: 'active',\n      permissions: {\n        patient_portal: true,\n        view_own_records: true,\n        book_appointments: true\n      }\n    };\n\n    const { data: user, error } = await supabase\n      .from('users')\n      .insert([userData])\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error linking auth user to patient:', error);\n      throw new Error(`Failed to create user record: ${error.message}`);\n    }\n\n    return user;\n  } catch (error) {\n    console.error('Error linking auth user to patient:', error);\n    throw error;\n  }\n}\n\n/**\n * Create an initial appointment if symptoms are provided\n */\nexport async function createInitialAppointment(\n  patientId: string,\n  registrationData: PatientRegistrationData\n): Promise<any> {\n  try {\n    if (!registrationData.initialSymptoms?.trim() && !registrationData.primaryComplaint?.trim()) {\n      return null; // No appointment needed if no symptoms\n    }\n\n    // Generate appointment ID\n    const appointmentId = `APT${Date.now()}`;\n    \n    // Use tomorrow as default appointment date\n    const tomorrow = new Date();\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    \n    const appointmentData = {\n      appointment_id: appointmentId,\n      patient_id: patientId,\n      appointment_date: tomorrow.toISOString().split('T')[0],\n      appointment_time: '09:00:00',\n      type: 'consultation',\n      status: 'scheduled',\n      symptoms: registrationData.initialSymptoms || registrationData.primaryComplaint,\n      notes: `Initial consultation for newly registered patient. Primary complaint: ${registrationData.primaryComplaint}`\n    };\n\n    const { data: appointment, error } = await supabase\n      .from('appointments')\n      .insert([appointmentData])\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error creating initial appointment:', error);\n      // Don't throw error for appointment creation failure\n      return null;\n    }\n\n    return appointment;\n  } catch (error) {\n    console.error('Error creating initial appointment:', error);\n    // Don't throw error for appointment creation failure\n    return null;\n  }\n}\n\n/**\n * Main function to register a new patient with complete workflow\n */\nexport async function registerNewPatient(\n  registrationData: PatientRegistrationData,\n  preGeneratedUHID?: string\n): Promise<PatientResponse> {\n  try {\n    // Step 1: Use pre-generated UHID or generate new one\n    const uhid = preGeneratedUHID || await generateUHID();\n    console.log('Using UHID:', uhid);\n\n    // Step 2: Create authentication credentials\n    const { authUser, credentials } = await createPatientAuthCredentials(uhid);\n    console.log('Created auth user:', authUser?.id);\n\n    // Step 3: Create user record in users table\n    const userRecord = await linkAuthUserToPatient(authUser.id, uhid, registrationData);\n    console.log('Created user record:', userRecord.id);\n\n    // Step 4: Insert patient record with user_id link\n    const patient = await insertPatientRecord(uhid, registrationData, userRecord.id);\n    console.log('Created patient record:', patient.id);\n\n    // Step 5: Create initial appointment if symptoms provided\n    if (registrationData.initialSymptoms?.trim() || registrationData.primaryComplaint?.trim()) {\n      const appointment = await createInitialAppointment(patient.id, registrationData);\n      if (appointment) {\n        console.log('Created initial appointment:', appointment.id);\n      }\n    }\n\n    return {\n      success: true,\n      patient,\n      uhid,\n      credentials,\n    };\n\n  } catch (error) {\n    console.error('Error registering new patient:', error);\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error occurred'\n    };\n  }\n}\n\n/**\n * Validate that UHID is unique\n */\nexport async function validateUHIDUnique(uhid: string): Promise<boolean> {\n  try {\n    const { data: existingPatient, error } = await supabase\n      .from('patients')\n      .select('patient_id')\n      .eq('patient_id', uhid)\n      .single();\n\n    if (error && error.code !== 'PGRST116') {\n      console.error('Error validating UHID uniqueness:', error);\n      throw new Error('Failed to validate UHID');\n    }\n\n    return !existingPatient; // Return true if no existing patient found\n  } catch (error) {\n    console.error('Error validating UHID uniqueness:', error);\n    throw error;\n  }\n}\n\n/**\n * Get patient by UHID with comprehensive data\n */\nexport async function getPatientByUHID(uhid: string): Promise<any> {\n  try {\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .select('*')\n      .eq('patient_id', uhid)\n      .single();\n\n    if (error) {\n      console.error('Error fetching patient by UHID:', error);\n      throw new Error(`Patient not found: ${error.message}`);\n    }\n\n    return patient;\n  } catch (error) {\n    console.error('Error fetching patient by UHID:', error);\n    throw error;\n  }\n}\n\n/**\n * Get patient with related data (appointments, bills, etc.)\n */\nexport async function getPatientWithRelatedData(uhid: string): Promise<any> {\n  try {\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .select(`\n        *,\n        users:user_id (\n          id,\n          name,\n          email,\n          role,\n          status,\n          permissions\n        ),\n        appointments:appointments(\n          id,\n          appointment_id,\n          appointment_date,\n          appointment_time,\n          type,\n          status,\n          symptoms,\n          diagnosis,\n          doctor:doctors(\n            id,\n            user:users(name, specialization)\n          )\n        ),\n        bed_allocations:bed_allocations(\n          id,\n          admission_date,\n          discharge_date,\n          admission_type,\n          status,\n          bed:beds(bed_number, room_number, bed_type),\n          doctor:doctors(\n            id,\n            user:users(name, specialization)\n          )\n        )\n      `)\n      .eq('patient_id', uhid)\n      .single();\n\n    if (error) {\n      console.error('Error fetching patient with related data:', error);\n      throw new Error(`Patient not found: ${error.message}`);\n    }\n\n    return patient;\n  } catch (error) {\n    console.error('Error fetching patient with related data:', error);\n    throw error;\n  }\n}\n\n/**\n * Update patient information\n */\nexport async function updatePatientRecord(\n  uhid: string, \n  updateData: Partial<PatientRegistrationData>\n): Promise<any> {\n  try {\n    const { data: patient, error } = await supabase\n      .from('patients')\n      .update(updateData)\n      .eq('patient_id', uhid)\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error updating patient record:', error);\n      throw new Error(`Failed to update patient: ${error.message}`);\n    }\n\n    return patient;\n  } catch (error) {\n    console.error('Error updating patient record:', error);\n    throw error;\n  }\n}\n\n/**\n * Get all patients with pagination and filtering\n */\nexport async function getAllPatients(\n  options: {\n    page?: number;\n    limit?: number;\n    status?: string;\n    searchTerm?: string;\n  } = {}\n): Promise<{ patients: any[]; total: number; page: number; limit: number }> {\n  try {\n    const { page = 1, limit = 20, status, searchTerm } = options;\n    const offset = (page - 1) * limit;\n\n    let query = supabase\n      .from('patients')\n      .select(`\n        *,\n        users:user_id (\n          id,\n          name,\n          email,\n          role,\n          status,\n          permissions\n        )\n      `, { count: 'exact' });\n\n    // Apply filters\n    if (status) {\n      query = query.eq('status', status);\n    }\n\n    if (searchTerm) {\n      query = query.or(`name.ilike.%${searchTerm}%,patient_id.ilike.%${searchTerm}%,phone.ilike.%${searchTerm}%`);\n    }\n\n    // Apply pagination\n    const { data: patients, error, count } = await query\n      .range(offset, offset + limit - 1)\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      console.error('Error fetching patients:', error);\n      throw new Error(`Failed to fetch patients: ${error.message}`);\n    }\n\n    return {\n      patients: patients || [],\n      total: count || 0,\n      page,\n      limit\n    };\n  } catch (error) {\n    console.error('Error fetching patients:', error);\n    throw error;\n  }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 680, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/vitalsService.ts"],"sourcesContent":["import { supabase } from './supabase';\n\n// Types for vitals management\nexport interface VitalSigns {\n  patientId: string;\n  visitId?: string;\n  recordedBy?: string; // Made optional to allow null values\n  \n  // Primary vital signs\n  systolicBp?: number;\n  diastolicBp?: number;\n  heartRate?: number;\n  temperature?: number;\n  respiratoryRate?: number;\n  oxygenSaturation?: number;\n  \n  // Physical measurements\n  weight?: number;\n  height?: number;\n  bmi?: number;\n  \n  // Additional measurements\n  bloodGlucose?: number;\n  painScale?: number; // 0-10 scale\n  \n  // Timestamps\n  recordedAt?: string;\n  \n  // Notes\n  notes?: string;\n}\n\nexport interface VitalRecord {\n  id: string;\n  patient_id: string;\n  // visit_id field removed as it doesn't exist in the database\n  recorded_by: string;\n  \n  // Vital signs\n  systolic_bp?: number;\n  diastolic_bp?: number;\n  heart_rate?: number;\n  temperature?: number;\n  respiratory_rate?: number;\n  oxygen_saturation?: number;\n  weight?: number;\n  height?: number;\n  bmi?: number;\n  blood_glucose?: number;\n  pain_scale?: number;\n  \n  // Timestamps\n  recorded_at: string;\n  \n  // Notes\n  notes?: string;\n  \n  // System fields\n  created_at: string;\n  \n  // Related data\n  patient?: any;\n  user?: { name: string };\n  visit?: any;\n}\n\nexport interface VitalTrends {\n  dates: string[];\n  heartRate: number[];\n  bloodPressure: { systolic: number; diastolic: number }[];\n  temperature: number[];\n  weight: number[];\n  oxygenSaturation: number[];\n}\n\n/**\n * Record new vital signs\n */\nexport async function recordVitals(vitalsData: VitalSigns): Promise<VitalRecord> {\n  try {\n    // Calculate BMI if height and weight are provided\n    let bmi = vitalsData.bmi;\n    if (vitalsData.height && vitalsData.weight) {\n      const heightInMeters = vitalsData.height / 100;\n      bmi = vitalsData.weight / (heightInMeters * heightInMeters);\n      bmi = Math.round(bmi * 10) / 10; // Round to 1 decimal place\n    }\n\n    const vitalRecord = {\n      patient_id: vitalsData.patientId,\n      recorded_by: vitalsData.recordedBy || null,\n      systolic_bp: vitalsData.systolicBp || null,\n      diastolic_bp: vitalsData.diastolicBp || null,\n      heart_rate: vitalsData.heartRate || null,\n      temperature: vitalsData.temperature || null,\n      respiratory_rate: vitalsData.respiratoryRate || null,\n      oxygen_saturation: vitalsData.oxygenSaturation || null,\n      weight: vitalsData.weight || null,\n      height: vitalsData.height || null,\n      bmi: bmi || null,\n      blood_glucose: vitalsData.bloodGlucose || null,\n      pain_scale: vitalsData.painScale || null,\n      recorded_at: vitalsData.recordedAt || new Date().toISOString(),\n      notes: vitalsData.notes || null\n    };\n\n    const { data: vital, error } = await supabase\n      .from('vitals')\n      .insert([vitalRecord])\n      .select('*')\n      .single();\n\n    if (error) {\n      console.error('Error recording vitals:', error);\n      throw new Error(`Failed to record vitals: ${error.message}`);\n    }\n\n    return vital;\n  } catch (error) {\n    console.error('Error recording vitals:', error);\n    throw error;\n  }\n}\n\n/**\n * Get patient vitals history\n */\nexport const getPatientVitals = async (patientId: string): Promise<VitalRecord[]> => {\n  try {\n    const { data, error } = await supabase.functions.invoke('get-vitals-with-user', {\n      body: { patientId },\n    });\n\n    if (error) {\n      console.error('Error fetching vitals via Edge Function:', error);\n      throw new Error('Failed to fetch vitals');\n    }\n\n    return (data?.vitals || []) as VitalRecord[];\n  } catch (err) {\n      console.error('Exception in getPatientVitals:', err);\n      throw err;\n  }\n};\n\n/**\n * Get latest vitals for a patient\n */\nexport async function getLatestVitals(patientId: string): Promise<VitalRecord | null> {\n  try {\n    const { data: vital, error } = await supabase\n      .from('vitals')\n      .select(`\n        *,\n        patient:patients(id, patient_id, name),\n        recorded_by_user:users!recorded_by(id, name, role),\n        visit:patient_visits(id, visit_id, visit_date, visit_type)\n      `)\n      .eq('patient_id', patientId)\n      .order('recorded_at', { ascending: false })\n      .limit(1)\n      .single();\n\n    if (error && error.code !== 'PGRST116') {\n      console.error('Error fetching latest vitals:', error);\n      throw new Error(`Failed to fetch latest vitals: ${error.message}`);\n    }\n\n    return vital || null;\n  } catch (error) {\n    console.error('Error fetching latest vitals:', error);\n    throw error;\n  }\n}\n\n/**\n * Get vitals trends for analysis\n */\nexport async function getVitalsTrends(\n  patientId: string,\n  days: number = 30\n): Promise<VitalTrends> {\n  try {\n    const endDate = new Date();\n    const startDate = new Date();\n    startDate.setDate(startDate.getDate() - days);\n\n    const { data: vitals, error } = await supabase\n      .from('vitals')\n      .select('recorded_at, systolic_bp, diastolic_bp, heart_rate, temperature, weight, oxygen_saturation')\n      .eq('patient_id', patientId)\n      .gte('recorded_at', startDate.toISOString())\n      .lte('recorded_at', endDate.toISOString())\n      .order('recorded_at', { ascending: true });\n\n    if (error) {\n      console.error('Error fetching vitals trends:', error);\n      throw new Error(`Failed to fetch vitals trends: ${error.message}`);\n    }\n\n    const trends: VitalTrends = {\n      dates: [],\n      heartRate: [],\n      bloodPressure: [],\n      temperature: [],\n      weight: [],\n      oxygenSaturation: []\n    };\n\n    vitals?.forEach(vital => {\n      const date = new Date(vital.recorded_at).toISOString().split('T')[0];\n      trends.dates.push(date);\n      \n      trends.heartRate.push(vital.heart_rate || 0);\n      trends.bloodPressure.push({\n        systolic: vital.systolic_bp || 0,\n        diastolic: vital.diastolic_bp || 0\n      });\n      trends.temperature.push(vital.temperature || 0);\n      trends.weight.push(vital.weight || 0);\n      trends.oxygenSaturation.push(vital.oxygen_saturation || 0);\n    });\n\n    return trends;\n  } catch (error) {\n    console.error('Error fetching vitals trends:', error);\n    throw error;\n  }\n}\n\n/**\n * Get vital statistics\n */\nexport async function getVitalStats(\n  patientId: string,\n  vitalType: 'heart_rate' | 'systolic_bp' | 'diastolic_bp' | 'temperature' | 'weight' | 'oxygen_saturation',\n  days: number = 30\n): Promise<{\n  current: number | null;\n  average: number;\n  min: number;\n  max: number;\n  readings: number;\n}> {\n  try {\n    const endDate = new Date();\n    const startDate = new Date();\n    startDate.setDate(startDate.getDate() - days);\n\n    const { data: vitals, error } = await supabase\n      .from('vitals')\n      .select(`recorded_at, ${vitalType}`)\n      .eq('patient_id', patientId)\n      .gte('recorded_at', startDate.toISOString())\n      .lte('recorded_at', endDate.toISOString())\n      .not(vitalType, 'is', null)\n      .order('recorded_at', { ascending: false });\n\n    if (error) {\n      console.error('Error fetching vital stats:', error);\n      throw new Error(`Failed to fetch vital stats: ${error.message}`);\n    }\n\n    const values = vitals?.map(v => (v as any)[vitalType] as number).filter(v => v !== null) || [];\n    \n    if (values.length === 0) {\n      return {\n        current: null,\n        average: 0,\n        min: 0,\n        max: 0,\n        readings: 0\n      };\n    }\n\n    const current = values[0];\n    const average = values.reduce((sum, val) => sum + val, 0) / values.length;\n    const min = Math.min(...values);\n    const max = Math.max(...values);\n\n    return {\n      current,\n      average: Math.round(average * 10) / 10,\n      min,\n      max,\n      readings: values.length\n    };\n  } catch (error) {\n    console.error('Error fetching vital stats:', error);\n    throw error;\n  }\n}\n\n/**\n * Check for vital alerts/abnormalities\n */\nexport async function checkVitalAlerts(patientId: string): Promise<{\n  alerts: Array<{\n    type: string;\n    message: string;\n    severity: 'low' | 'medium' | 'high' | 'critical';\n    value: number;\n    normalRange: string;\n  }>;\n}> {\n  try {\n    const latestVital = await getLatestVitals(patientId);\n    \n    if (!latestVital) {\n      return { alerts: [] };\n    }\n\n    const alerts: Array<{\n      type: string;\n      message: string;\n      severity: 'low' | 'medium' | 'high' | 'critical';\n      value: number;\n      normalRange: string;\n    }> = [];\n\n    // Blood pressure alerts\n    if (latestVital.systolic_bp && latestVital.diastolic_bp) {\n      const systolic = latestVital.systolic_bp;\n      const diastolic = latestVital.diastolic_bp;\n      \n      if (systolic >= 180 || diastolic >= 110) {\n        alerts.push({\n          type: 'blood_pressure',\n          message: 'Hypertensive Crisis - Immediate attention required',\n          severity: 'critical',\n          value: systolic,\n          normalRange: '90-139/60-89 mmHg'\n        });\n      } else if (systolic >= 140 || diastolic >= 90) {\n        alerts.push({\n          type: 'blood_pressure',\n          message: 'High Blood Pressure',\n          severity: 'high',\n          value: systolic,\n          normalRange: '90-139/60-89 mmHg'\n        });\n      } else if (systolic < 90 || diastolic < 60) {\n        alerts.push({\n          type: 'blood_pressure',\n          message: 'Low Blood Pressure',\n          severity: 'medium',\n          value: systolic,\n          normalRange: '90-139/60-89 mmHg'\n        });\n      }\n    }\n\n    // Heart rate alerts\n    if (latestVital.heart_rate) {\n      const hr = latestVital.heart_rate;\n      if (hr > 100) {\n        alerts.push({\n          type: 'heart_rate',\n          message: 'Tachycardia - Elevated heart rate',\n          severity: hr > 120 ? 'high' : 'medium',\n          value: hr,\n          normalRange: '60-100 bpm'\n        });\n      } else if (hr < 60) {\n        alerts.push({\n          type: 'heart_rate',\n          message: 'Bradycardia - Low heart rate',\n          severity: hr < 50 ? 'high' : 'medium',\n          value: hr,\n          normalRange: '60-100 bpm'\n        });\n      }\n    }\n\n    // Temperature alerts\n    if (latestVital.temperature) {\n      const temp = latestVital.temperature;\n      if (temp >= 39.0) {\n        alerts.push({\n          type: 'temperature',\n          message: 'High Fever',\n          severity: 'high',\n          value: temp,\n          normalRange: '36.1-37.2C'\n        });\n      } else if (temp >= 38.0) {\n        alerts.push({\n          type: 'temperature',\n          message: 'Fever',\n          severity: 'medium',\n          value: temp,\n          normalRange: '36.1-37.2C'\n        });\n      } else if (temp < 36.0) {\n        alerts.push({\n          type: 'temperature',\n          message: 'Low body temperature',\n          severity: 'medium',\n          value: temp,\n          normalRange: '36.1-37.2C'\n        });\n      }\n    }\n\n    // Oxygen saturation alerts\n    if (latestVital.oxygen_saturation) {\n      const spo2 = latestVital.oxygen_saturation;\n      if (spo2 < 90) {\n        alerts.push({\n          type: 'oxygen_saturation',\n          message: 'Low oxygen saturation - Immediate attention required',\n          severity: 'critical',\n          value: spo2,\n          normalRange: '95-100%'\n        });\n      } else if (spo2 < 95) {\n        alerts.push({\n          type: 'oxygen_saturation',\n          message: 'Below normal oxygen saturation',\n          severity: 'high',\n          value: spo2,\n          normalRange: '95-100%'\n        });\n      }\n    }\n\n    return { alerts };\n  } catch (error) {\n    console.error('Error checking vital alerts:', error);\n    throw error;\n  }\n}\n\n/**\n * Get vitals summary for dashboard\n */\nexport async function getVitalsSummary(patientId: string): Promise<{\n  latestVitals: VitalRecord | null;\n  alerts: Array<{\n    type: string;\n    message: string;\n    severity: 'low' | 'medium' | 'high' | 'critical';\n    value: number;\n    normalRange: string;\n  }>;\n  totalReadings: number;\n  lastRecordedAt: string | null;\n}> {\n  try {\n    const [latestVitals, alertsData, totalCount] = await Promise.all([\n      getLatestVitals(patientId),\n      checkVitalAlerts(patientId),\n      supabase\n        .from('vitals')\n        .select('id', { count: 'exact', head: true })\n        .eq('patient_id', patientId)\n    ]);\n\n    return {\n      latestVitals,\n      alerts: alertsData.alerts,\n      totalReadings: totalCount.count || 0,\n      lastRecordedAt: latestVitals?.recorded_at || null\n    };\n  } catch (error) {\n    console.error('Error getting vitals summary:', error);\n    throw error;\n  }\n}\n\n/**\n * Update vital record\n */\nexport async function updateVitalRecord(\n  vitalId: string,\n  updates: Partial<VitalSigns>\n): Promise<VitalRecord> {\n  try {\n    // Calculate BMI if height and weight are provided\n    let bmi = updates.bmi;\n    if (updates.height && updates.weight) {\n      const heightInMeters = updates.height / 100;\n      bmi = updates.weight / (heightInMeters * heightInMeters);\n      bmi = Math.round(bmi * 10) / 10; // Round to 1 decimal place\n    }\n\n    const updateData: any = {};\n    \n    if (updates.systolicBp !== undefined) updateData.systolic_bp = updates.systolicBp;\n    if (updates.diastolicBp !== undefined) updateData.diastolic_bp = updates.diastolicBp;\n    if (updates.heartRate !== undefined) updateData.heart_rate = updates.heartRate;\n    if (updates.temperature !== undefined) updateData.temperature = updates.temperature;\n    if (updates.respiratoryRate !== undefined) updateData.respiratory_rate = updates.respiratoryRate;\n    if (updates.oxygenSaturation !== undefined) updateData.oxygen_saturation = updates.oxygenSaturation;\n    if (updates.weight !== undefined) updateData.weight = updates.weight;\n    if (updates.height !== undefined) updateData.height = updates.height;\n    if (bmi !== undefined) updateData.bmi = bmi;\n    if (updates.bloodGlucose !== undefined) updateData.blood_glucose = updates.bloodGlucose;\n    if (updates.painScale !== undefined) updateData.pain_scale = updates.painScale;\n    if (updates.notes !== undefined) updateData.notes = updates.notes;\n\n    const { data: vital, error } = await supabase\n      .from('vitals')\n      .update(updateData)\n      .eq('id', vitalId)\n      .select(`\n        *,\n        patient:patients(id, patient_id, name),\n        recorded_by_user:users!recorded_by(id, name, role),\n        visit:patient_visits(id, visit_id, visit_date, visit_type)\n      `)\n      .single();\n\n    if (error) {\n      console.error('Error updating vital record:', error);\n      throw new Error(`Failed to update vital record: ${error.message}`);\n    }\n\n    return vital;\n  } catch (error) {\n    console.error('Error updating vital record:', error);\n    throw error;\n  }\n}\n\n/**\n * Delete vital record\n */\nexport async function deleteVitalRecord(vitalId: string): Promise<void> {\n  try {\n    const { error } = await supabase\n      .from('vitals')\n      .delete()\n      .eq('id', vitalId);\n\n    if (error) {\n      console.error('Error deleting vital record:', error);\n      throw new Error(`Failed to delete vital record: ${error.message}`);\n    }\n  } catch (error) {\n    console.error('Error deleting vital record:', error);\n    throw error;\n  }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1043, "column": 0}, "map": {"version":3,"sources":["file:///Users/nisha/Desktop/hms/untitled%20folder/project/src/lib/medicalHistoryService.ts"],"sourcesContent":["import { supabase } from './supabase';\n\nexport interface MedicalHistoryEvent {\n  id: string;\n  patient_id: string;\n  event_type: string;\n  event_name: string;\n  event_date: string;\n  details: string | null;\n  doctor_name: string | null;\n  facility_name: string | null;\n  source: 'history' | 'symptom' | 'allergy';\n}\n\nexport interface CreateMedicalHistoryInput {\n  patientId: string;\n  eventType: string;\n  eventName: string;\n  eventDate: string;\n  details?: string;\n  doctorName?: string;\n  facilityName?: string;\n}\n\nexport const createMedicalHistory = async (input: CreateMedicalHistoryInput): Promise<MedicalHistoryEvent> => {\n  if (!input.patientId) {\n    throw new Error('Patient ID is required to create medical history.');\n  }\n\n  try {\n    const { data, error } = await supabase\n      .from('medical_history')\n      .insert({\n        patient_id: input.patientId,\n        event_type: input.eventType,\n        event_name: input.eventName,\n        event_date: input.eventDate,\n        details: input.details || null,\n        doctor_name: input.doctorName || null,\n        facility_name: input.facilityName || null\n      })\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error creating medical history:', error);\n      throw new Error('Failed to create medical history entry.');\n    }\n\n    return { ...data, source: 'history' };\n  } catch (error) {\n    console.error('An unexpected error occurred while creating medical history:', error);\n    throw error;\n  }\n};\n\n// Add some dummy medical history data for testing\nexport const addDummyMedicalHistory = async (patientId: string): Promise<MedicalHistoryEvent[]> => {\n  const dummyData: CreateMedicalHistoryInput[] = [\n    {\n      patientId,\n      eventType: 'Diagnosis',\n      eventName: 'Hypertension',\n      eventDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(), // 30 days ago\n      details: 'Diagnosed with Stage 1 Hypertension. Prescribed lifestyle changes and monitoring.',\n      doctorName: 'Dr. Sarah Johnson',\n      facilityName: 'City General Hospital'\n    },\n    {\n      patientId,\n      eventType: 'Surgery',\n      eventName: 'Appendectomy',\n      eventDate: new Date(Date.now() - 180 * 24 * 60 * 60 * 1000).toISOString(), // 6 months ago\n      details: 'Laparoscopic appendectomy performed due to acute appendicitis. Recovery was uneventful.',\n      doctorName: 'Dr. Michael Chen',\n      facilityName: 'University Medical Center'\n    },\n    {\n      patientId,\n      eventType: 'Vaccination',\n      eventName: 'COVID-19 Vaccine',\n      eventDate: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000).toISOString(), // 3 months ago\n      details: 'Received second dose of COVID-19 vaccine. No adverse reactions reported.',\n      doctorName: 'Dr. Lisa Wong',\n      facilityName: 'Community Health Clinic'\n    }\n  ];\n\n  const results: MedicalHistoryEvent[] = [];\n  \n  for (const entry of dummyData) {\n    try {\n      const result = await createMedicalHistory(entry);\n      results.push(result);\n    } catch (error) {\n      console.error('Error adding dummy data:', error);\n    }\n  }\n\n  return results;\n};\n\nexport const getMedicalHistory = async (patientId: string): Promise<MedicalHistoryEvent[]> => {\n  if (!patientId) {\n    console.error('Patient ID is required to fetch medical history.');\n    return [];\n  }\n\n  try {\n    // Fetch from medical_history table\n    const { data: historyData, error: historyError } = await supabase\n      .from('medical_history')\n      .select('*')\n      .eq('patient_id', patientId);\n\n    if (historyError) {\n      console.error('Error fetching medical history:', historyError);\n      throw new Error('Failed to fetch medical history.');\n    }\n\n    // Fetch from patient_symptoms table\n    const { data: symptomsData, error: symptomsError } = await supabase\n      .from('patient_symptoms')\n      .select('*')\n      .eq('patient_id', patientId);\n\n    if (symptomsError) {\n      console.error('Error fetching patient symptoms:', symptomsError);\n      throw new Error('Failed to fetch patient symptoms.');\n    }\n\n    // Fetch from patient_allergies table\n    const { data: allergiesData, error: allergiesError } = await supabase\n      .from('patient_allergies')\n      .select('*')\n      .eq('patient_id', patientId);\n\n    if (allergiesError) {\n      console.error('Error fetching patient allergies:', allergiesError);\n      throw new Error('Failed to fetch patient allergies.');\n    }\n\n    // Normalize and combine the data\n    const combinedHistory: MedicalHistoryEvent[] = [];\n\n    if (historyData) {\n      historyData.forEach(item => {\n        combinedHistory.push({ ...item, source: 'history' });\n      });\n    }\n\n    if (symptomsData) {\n      symptomsData.forEach(item => {\n        combinedHistory.push({\n          id: item.id,\n          patient_id: item.patient_id,\n          event_type: 'Symptom',\n          event_name: item.symptom_name,\n          event_date: item.recorded_at,\n          details: `Severity: ${item.severity}, Onset: ${item.onset_date}`,\n          doctor_name: null,\n          facility_name: null,\n          source: 'symptom',\n        });\n      });\n    }\n\n    if (allergiesData) {\n      allergiesData.forEach(item => {\n        combinedHistory.push({\n          id: item.id,\n          patient_id: item.patient_id,\n          event_type: 'Allergy',\n          event_name: item.allergen,\n          event_date: item.recorded_at,\n          details: `Reaction: ${item.reaction}, Severity: ${item.severity}`,\n          doctor_name: null,\n          facility_name: null,\n          source: 'allergy',\n        });\n      });\n    }\n\n    // Sort by event date, most recent first\n    combinedHistory.sort((a, b) => new Date(b.event_date).getTime() - new Date(a.event_date).getTime());\n\n    return combinedHistory;\n\n  } catch (error) {\n    console.error('An unexpected error occurred while fetching medical history:', error);\n    throw error;\n  }\n};\n"],"names":[],"mappings":"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","debugId":null}}]
}