(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9961],{1090:(e,s,t)=>{Promise.resolve().then(t.bind(t,1233))},1233:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>J});var a=t(5155),r=t(2115),i=t(5339),l=t(1007),n=t(7550),o=t(3717),d=t(215),c=t(4616),m=t(9074),x=t(9420),g=t(8883),u=t(4516),h=t(1976),p=t(1243),y=t(3917),b=t(8136),j=t(4186),f=t(7434),N=t(2657),v=t(9397),w=t(5273),_=t(646),S=t(6643),A=t(306),D=t(4835),C=t(4416),k=t(8393),P=t(2099);async function E(e){try{console.log("recordVitals called with:",e);let s=e.patientId;if(!e.patientId.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)){let{data:t,error:a}=await P.ND.from("patients").select("id").eq("patient_id",e.patientId).single();if(a||!t)throw Error("Patient not found: ".concat(e.patientId));s=t.id}if(!e.recordedBy){console.error("No recordedBy provided:",e.recordedBy);let{data:s}=await P.ND.from("users").select("id, name, role").in("role",["doctor","md","admin"]).limit(1).single();if(s)console.log("Using default user:",s),e.recordedBy=s.id;else throw Error("No valid user found to record vitals. Please ensure you are logged in.")}console.log("Checking if user exists with ID:",e.recordedBy);let{data:t,error:a}=await P.ND.from("users").select("id, name, role").eq("id",e.recordedBy).single();if(console.log("User lookup result:",{user:t,userError:a}),a||!t){console.error("User validation failed:",{userError:a,user:t});let{data:s}=await P.ND.from("users").select("id, name, role").in("role",["doctor","md","admin"]).limit(1).single();if(s)console.log("Using fallback user:",s),e.recordedBy=s.id;else throw Error("No valid users found in the system. Please contact administrator.")}else console.log("User validated successfully:",t);let r={patient_id:s,recorded_by:e.recordedBy,blood_pressure_systolic:e.bloodPressureSystolic,blood_pressure_diastolic:e.bloodPressureDiastolic,heart_rate:e.heartRate,temperature:e.temperature,respiratory_rate:e.respiratoryRate,oxygen_saturation:e.oxygenSaturation,weight:e.weight,height:e.height,pain_scale:e.painScale,blood_glucose:e.bloodGlucose,notes:e.notes,recorded_at:e.recordedAt||new Date().toISOString()};console.log("Inserting vital record:",r);let{data:i,error:l}=await P.ND.from("vitals").insert(r).select("*").single();if(console.log("Insert result:",{data:i,error:l}),l)throw console.error("Database insert error:",l),Error("Failed to record vitals: ".concat(l.message));let[n,o]=await Promise.all([P.ND.from("patients").select("patient_id, name").eq("id",i.patient_id).single(),P.ND.from("users").select("name").eq("id",i.recorded_by).single()]);return{...i,patient:n.data,recorded_by_user:o.data}}catch(e){throw console.error("Error in recordVitals:",e),e}}async function q(e){try{let s=e;if(!e.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)){let{data:t,error:a}=await P.ND.from("patients").select("id").eq("patient_id",e).single();if(a||!t)return[];s=t.id}let{data:t,error:a}=await P.ND.from("vitals").select("*").eq("patient_id",s).order("recorded_at",{ascending:!1});if(a)throw console.error("Error fetching patient vitals:",a),Error("Failed to fetch patient vitals: ".concat(a.message));return await Promise.all(t.map(async e=>{let[s,t]=await Promise.all([P.ND.from("patients").select("patient_id, name").eq("id",e.patient_id).single(),P.ND.from("users").select("name").eq("id",e.recorded_by).single()]);return{...e,patient:s.data,recorded_by_user:t.data}}))}catch(e){throw console.error("Error in getPatientVitals:",e),e}}async function R(e,s){try{let t={blood_pressure_systolic:s.bloodPressureSystolic,blood_pressure_diastolic:s.bloodPressureDiastolic,heart_rate:s.heartRate,temperature:s.temperature,respiratory_rate:s.respiratoryRate,oxygen_saturation:s.oxygenSaturation,weight:s.weight,height:s.height,pain_scale:s.painScale,blood_glucose:s.bloodGlucose,notes:s.notes,updated_at:new Date().toISOString()},{data:a,error:r}=await P.ND.from("vitals").update(t).eq("id",e).select("*").single();if(r)throw console.error("Error updating vital record:",r),Error("Failed to update vital record: ".concat(r.message));let[i,l]=await Promise.all([P.ND.from("patients").select("patient_id, name").eq("id",a.patient_id).single(),P.ND.from("users").select("name").eq("id",a.recorded_by).single()]);return{...a,patient:i.data,recorded_by_user:l.data}}catch(e){throw console.error("Error in updateVitalRecord:",e),e}}let I=async e=>{if(!e.patientId)throw Error("Patient ID is required to create medical history.");try{let{data:s,error:t}=await P.ND.from("medical_history").insert({patient_id:e.patientId,event_type:e.eventType,event_name:e.eventName,event_date:e.eventDate,details:e.details||null,doctor_name:e.doctorName||null,facility_name:e.facilityName||null}).select().single();if(t){if("42P01"===t.code)throw Error("Medical history table does not exist. Please contact system administrator.");throw console.error("Error creating medical history:",t),Error("Failed to create medical history entry.")}return{...s,source:"history"}}catch(e){throw console.error("An unexpected error occurred while creating medical history:",e),e}},T=async e=>{let s=[{patientId:e,eventType:"Diagnosis",eventName:"Hypertension",eventDate:new Date(Date.now()-2592e6).toISOString(),details:"Diagnosed with Stage 1 Hypertension. Prescribed lifestyle changes and monitoring.",doctorName:"Dr. Sarah Johnson",facilityName:"City General Hospital"},{patientId:e,eventType:"Surgery",eventName:"Appendectomy",eventDate:new Date(Date.now()-15552e6).toISOString(),details:"Laparoscopic appendectomy performed due to acute appendicitis. Recovery was uneventful.",doctorName:"Dr. Michael Chen",facilityName:"University Medical Center"},{patientId:e,eventType:"Vaccination",eventName:"COVID-19 Vaccine",eventDate:new Date(Date.now()-7776e6).toISOString(),details:"Received second dose of COVID-19 vaccine. No adverse reactions reported.",doctorName:"Dr. Lisa Wong",facilityName:"Community Health Clinic"}],t=[];for(let e of s)try{let s=await I(e);t.push(s)}catch(e){console.error("Error adding dummy data:",e)}return t},F=async e=>{if(!e)return console.error("Patient ID is required to fetch medical history."),[];try{var s,t,a,r,i,l;let n=[];try{let{data:s,error:t}=await P.ND.from("medical_history").select("*").eq("patient_id",e);t?"42P01"===t.code?console.log("Medical history table does not exist, skipping"):"PGRST116"!==t.code&&console.error("Error fetching medical history:",t):s&&s.forEach(e=>{n.push({...e,source:"history"})})}catch(e){(null==(s=e.message)?void 0:s.includes("relation"))&&(null==(t=e.message)?void 0:t.includes("does not exist"))?console.log("Medical history table does not exist, skipping"):console.warn("Medical history table may not exist:",e)}try{let{data:s,error:t}=await P.ND.from("patient_symptoms").select("*").eq("patient_id",e);t?"42P01"===t.code?console.log("Patient symptoms table does not exist, skipping"):"PGRST116"!==t.code&&console.error("Error fetching patient symptoms:",t):s&&s.forEach(e=>{n.push({id:e.id,patient_id:e.patient_id,event_type:"Symptom",event_name:e.symptom_name,event_date:e.recorded_at,details:"Severity: ".concat(e.severity,", Onset: ").concat(e.onset_date),doctor_name:null,facility_name:null,source:"symptom"})})}catch(e){(null==(a=e.message)?void 0:a.includes("relation"))&&(null==(r=e.message)?void 0:r.includes("does not exist"))?console.log("Patient symptoms table does not exist, skipping"):console.warn("Patient symptoms table may not exist:",e)}try{let{data:s,error:t}=await P.ND.from("patient_allergies").select("*").eq("patient_id",e);t?"42P01"===t.code?console.log("Patient allergies table does not exist, skipping"):"PGRST116"!==t.code&&console.error("Error fetching patient allergies:",t):s&&s.forEach(e=>{n.push({id:e.id,patient_id:e.patient_id,event_type:"Allergy",event_name:e.allergen,event_date:e.recorded_at,details:"Reaction: ".concat(e.reaction,", Severity: ").concat(e.severity),doctor_name:null,facility_name:null,source:"allergy"})})}catch(e){(null==(i=e.message)?void 0:i.includes("relation"))&&(null==(l=e.message)?void 0:l.includes("does not exist"))?console.log("Patient allergies table does not exist, skipping"):console.warn("Patient allergies table may not exist:",e)}return n.sort((e,s)=>new Date(s.event_date).getTime()-new Date(e.event_date).getTime()),n}catch(e){return console.error("An unexpected error occurred while fetching medical history:",e),[]}};function M(e){let{patientId:s,onClose:t,onSuccess:i}=e,[l,n]=(0,r.useState)({patientId:s,eventType:"",eventName:"",eventDate:new Date().toISOString().split("T")[0],details:"",doctorName:"",facilityName:""}),[o,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)(null),x=e=>{let{name:s,value:t}=e.target;n(e=>({...e,[s]:t}))},g=async e=>{e.preventDefault(),d(!0),m(null);try{await I(l),i(),t()}catch(e){console.error("Error creating medical history:",e),m("Failed to create medical history entry. Please try again.")}finally{d(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Add Medical Event"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(C.A,{className:"h-5 w-5"})})]}),c&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:c}),(0,a.jsx)("form",{onSubmit:g,children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"eventType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Type"}),(0,a.jsxs)("select",{id:"eventType",name:"eventType",value:l.eventType,onChange:x,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select Event Type"}),(0,a.jsx)("option",{value:"Diagnosis",children:"Diagnosis"}),(0,a.jsx)("option",{value:"Surgery",children:"Surgery"}),(0,a.jsx)("option",{value:"Vaccination",children:"Vaccination"}),(0,a.jsx)("option",{value:"Medication",children:"Medication"}),(0,a.jsx)("option",{value:"Test",children:"Test/Lab Result"}),(0,a.jsx)("option",{value:"Procedure",children:"Procedure"}),(0,a.jsx)("option",{value:"Visit",children:"Visit"}),(0,a.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"eventName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Name"}),(0,a.jsx)("input",{type:"text",id:"eventName",name:"eventName",value:l.eventName,onChange:x,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"e.g., Appendectomy, Flu Shot, etc.",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"eventDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,a.jsx)("input",{type:"date",id:"eventDate",name:"eventDate",value:l.eventDate,onChange:x,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"details",className:"block text-sm font-medium text-gray-700 mb-1",children:"Details"}),(0,a.jsx)("textarea",{id:"details",name:"details",value:l.details||"",onChange:x,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",rows:3,placeholder:"Enter any relevant details about this medical event"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"doctorName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Doctor Name"}),(0,a.jsx)("input",{type:"text",id:"doctorName",name:"doctorName",value:l.doctorName||"",onChange:x,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Dr. Name (optional)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"facilityName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Facility Name"}),(0,a.jsx)("input",{type:"text",id:"facilityName",name:"facilityName",value:l.facilityName||"",onChange:x,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Hospital or clinic name (optional)"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:o,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 disabled:bg-orange-300",disabled:o,children:o?"Saving...":"Save Medical Event"})]})]})})]})})}function L(e){let{patientId:s,onSuccess:t}=e,[i,l]=(0,r.useState)(!1),n=async()=>{if(s){l(!0);try{await T(s),t()}catch(e){console.error("Error adding dummy data:",e)}finally{l(!1)}}};return(0,a.jsx)("button",{onClick:n,disabled:i,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:bg-blue-300",children:i?"Adding...":"Add Dummy Data"})}var B=t(7924),V=t(7809),G=t(7108),H=t(1563);function O(e){let{patientId:s}=e,[t,n]=(0,r.useState)([]),[o,c]=(0,r.useState)(!0),[x,g]=(0,r.useState)(null),[u,h]=(0,r.useState)("all"),[p,y]=(0,r.useState)("");(0,r.useEffect)(()=>{b()},[s]);let b=async()=>{try{c(!0);let e=await (0,H.Xv)(s);n(e)}catch(e){g("Failed to load medication history"),console.error("Error loading medication history:",e)}finally{c(!1)}},f=t.filter(e=>{let s="all"===u||"prescribed"===u&&!e.dispensed_date||"dispensed"===u&&e.dispensed_date,t=!p||e.medication_name.toLowerCase().includes(p.toLowerCase())||e.dosage.toLowerCase().includes(p.toLowerCase());return s&&t}),N=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),v=e=>e.dispensed_date?(0,a.jsx)(_.A,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(j.A,{className:"h-5 w-5 text-yellow-500"}),w=e=>e.dispensed_date?"Dispensed":"Prescribed",S=e=>e.dispensed_date?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200";return o?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading medication history..."})]}):x?(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i.A,{className:"h-5 w-5 text-red-500 mr-2"}),(0,a.jsx)("span",{className:"text-red-700",children:x})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,a.jsx)(d.A,{className:"h-5 w-5 text-orange-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"Medication History"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Prescribed and dispensed medications"})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(B.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search medications...",value:p,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>h("all"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("all"===u?"bg-orange-100 text-orange-700 border border-orange-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"All"}),(0,a.jsx)("button",{onClick:()=>h("prescribed"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("prescribed"===u?"bg-orange-100 text-orange-700 border border-orange-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Prescribed"}),(0,a.jsx)("button",{onClick:()=>h("dispensed"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("dispensed"===u?"bg-orange-100 text-orange-700 border border-orange-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Dispensed"})]})]}),0===f.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(d.A,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No medications found"}),(0,a.jsx)("p",{className:"text-gray-600",children:p||"all"!==u?"Try adjusting your search or filter criteria.":"No medications have been prescribed for this patient yet."})]}):(0,a.jsx)("div",{className:"space-y-4",children:f.map((e,s)=>(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(d.A,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.medication_name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.dosage})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),(0,a.jsxs)("span",{children:["Prescribed: ",N(e.prescribed_date)]})]}),e.dispensed_date&&(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(V.A,{className:"h-4 w-4 mr-2"}),(0,a.jsxs)("span",{children:["Dispensed: ",N(e.dispensed_date)]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(l.A,{className:"h-4 w-4 mr-2"}),(0,a.jsxs)("span",{children:["By: ",e.prescribed_by]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(G.A,{className:"h-4 w-4 mr-2"}),(0,a.jsxs)("span",{children:["Frequency: ",e.frequency]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-2"}),(0,a.jsxs)("span",{children:["Duration: ",e.duration]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[v(e),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(S(e)),children:w(e)})]})]})},s))})]})}var U=t(2525);function z(e){let{patientId:s,patientName:t,onClose:i,onPrescriptionCreated:l,currentUser:n}=e,[o,x]=(0,r.useState)([]),[g,u]=(0,r.useState)(""),[h,p]=(0,r.useState)([]),[b,j]=(0,r.useState)(""),[N,v]=(0,r.useState)(""),[w,S]=(0,r.useState)(""),[A,D]=(0,r.useState)(!1),[k,E]=(0,r.useState)([]),[q,R]=(0,r.useState)(!1);(0,r.useEffect)(()=>{I()},[]);let I=async()=>{try{let{data:e,error:s}=await P.ND.from("medications").select("id, medication_code, name, generic_name, manufacturer, category, dosage_form, strength, unit_price, stock_quantity").gt("stock_quantity",0).order("name",{ascending:!0});if(s)throw s;x(e||[])}catch(e){console.error("Error fetching medications:",e)}},T=e=>{if(!e.trim())return void E([]);E(o.filter(s=>s.name.toLowerCase().includes(e.toLowerCase())||s.generic_name.toLowerCase().includes(e.toLowerCase())||s.category.toLowerCase().includes(e.toLowerCase())))},F=e=>{p([...h,{medication_id:e.id,medication_name:e.name,dosage:"",frequency:"",frequency_times:[],meal_timing:"",duration:"",duration_days:1,instructions:"",quantity:1,auto_calculate_quantity:!0,unit_price:e.unit_price,total_price:e.unit_price,stock_quantity:e.stock_quantity}]),u(""),E([]),R(!1)},M=(e,s)=>e.length*s,L=(e,s,t)=>{let a=[...h];if(a[e]={...a[e],[s]:t},a[e].auto_calculate_quantity&&("frequency_times"===s||"duration_days"===s)){let s=M(a[e].frequency_times,a[e].duration_days);a[e].quantity=s,a[e].total_price=a[e].unit_price*s}else"quantity"===s&&(a[e].total_price=a[e].unit_price*t);p(a)},V=e=>{p(h.filter((s,t)=>t!==e))},G=async e=>{if(e.preventDefault(),0===h.length)return void alert("Please add at least one medication to the prescription.");D(!0);try{let{data:e,error:t}=await P.ND.from("prescriptions").insert({patient_id:s,doctor_id:(null==n?void 0:n.id)||null,issue_date:new Date().toISOString().split("T")[0],instructions:"Diagnosis: ".concat(b,"\nNotes: ").concat(N,"\nFollow-up: ").concat(w||"Not specified"),status:"active"}).select().single();if(t)throw t;let a=e.id;for(let e of h){let{error:s}=await P.ND.from("prescription_items").insert({prescription_id:a,medication_id:e.medication_id,dosage:e.dosage,frequency:e.frequency,duration:e.duration,instructions:e.instructions,quantity:e.quantity,unit_price:e.unit_price,total_price:e.total_price});if(s)throw s}l(),i()}catch(e){console.error("Error creating prescription:",e),alert("Error creating prescription. Please try again.")}finally{D(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[95vh] flex flex-col",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border-b border-green-100 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(d.A,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"New Prescription"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["For ",t]})]})]}),(0,a.jsx)("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,a.jsx)(C.A,{className:"h-5 w-5 text-gray-500"})})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,a.jsxs)("form",{onSubmit:G,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 inline mr-2"}),"Diagnosis *"]}),(0,a.jsx)("textarea",{value:b,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:3,placeholder:"Enter patient diagnosis...",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(f.A,{className:"h-4 w-4 inline mr-2"}),"Additional Notes"]}),(0,a.jsx)("textarea",{value:N,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:3,placeholder:"Additional instructions or notes..."})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 inline mr-2"}),"Follow-up Date"]}),(0,a.jsx)("input",{type:"date",value:w,onChange:e=>S(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:new Date().toISOString().split("T")[0]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Medications"}),(0,a.jsxs)("button",{type:"button",onClick:()=>R(!q),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"Add Medication"]})]}),q&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(B.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,a.jsx)("input",{type:"text",value:g,onChange:e=>{u(e.target.value),T(e.target.value)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Search medications by name, generic name, or category..."})]}),k.length>0&&(0,a.jsx)("div",{className:"mt-3 max-h-60 overflow-y-auto border border-gray-200 rounded-lg",children:k.map(e=>(0,a.jsx)("div",{onClick:()=>F(e),className:"p-3 hover:bg-green-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.generic_name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.category," • ",e.dosage_form," • ",e.strength]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-green-600",children:["₹",e.unit_price]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.stock_quantity," units available"]})]})]})},e.id))})]}),h.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[h.map((e,s)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-white",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.medication_name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Stock: ",e.stock_quantity," units available"]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>V(s),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:(0,a.jsx)(U.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Dosage"}),(0,a.jsx)("input",{type:"text",value:e.dosage,onChange:e=>L(s,"dosage",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., 500mg, 1 tablet"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Frequency"}),(0,a.jsxs)("select",{value:e.frequency,onChange:e=>L(s,"frequency",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"Select frequency"}),(0,a.jsx)("option",{value:"once_daily",children:"Once Daily"}),(0,a.jsx)("option",{value:"twice_daily",children:"Twice Daily"}),(0,a.jsx)("option",{value:"three_times_daily",children:"Three Times Daily"}),(0,a.jsx)("option",{value:"four_times_daily",children:"Four Times Daily"}),(0,a.jsx)("option",{value:"as_needed",children:"As Needed"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Duration"}),(0,a.jsx)("input",{type:"text",value:e.duration,onChange:e=>L(s,"duration",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., 7 days, 2 weeks"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Frequency Times"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:["Morning","Afternoon","Evening","Night"].map(t=>(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.frequency_times.includes(t),onChange:a=>{L(s,"frequency_times",a.target.checked?[...e.frequency_times,t]:e.frequency_times.filter(e=>e!==t))},className:"mr-2 text-green-500 focus:ring-green-500"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:t})]},t))})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Meal Timing"}),(0,a.jsxs)("select",{value:e.meal_timing,onChange:e=>L(s,"meal_timing",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"Select meal timing"}),(0,a.jsx)("option",{value:"before_meal",children:"Before Meal"}),(0,a.jsx)("option",{value:"after_meal",children:"After Meal"}),(0,a.jsx)("option",{value:"with_meal",children:"With Meal"}),(0,a.jsx)("option",{value:"empty_stomach",children:"Empty Stomach"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Instructions"}),(0,a.jsx)("textarea",{value:e.instructions,onChange:e=>L(s,"instructions",e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Take after meals, Avoid alcohol, Complete the full course",rows:2}),e.meal_timing&&(0,a.jsxs)("p",{className:"mt-1 text-xs text-blue-600",children:["Meal timing: ",e.meal_timing.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())]}),e.frequency_times.length>0&&(0,a.jsxs)("p",{className:"mt-1 text-xs text-green-600",children:["Times: ",e.frequency_times.join(", ")," (",e.frequency_times.length," times daily)"]})]})]},s)),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:"Total Medications:"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:[h.length," items"]})]})})]}),0===h.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(d.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:'No medications added yet. Click "Add Medication" to start prescribing.'})]})]})]})}),(0,a.jsx)("div",{className:"border-t border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:i,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:G,disabled:A||0===h.length,className:"px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.A,{className:"h-4 w-4"}),"Create Prescription"]})})]})})]})})}var W=t(6874),Y=t.n(W),$=t(5695);function J(e){var s,t;let{params:C}=e,E=r.use(C),R=(0,$.useRouter)(),[I,T]=(0,r.useState)(null),[B,V]=(0,r.useState)(!0),[G,H]=(0,r.useState)(null),[U,W]=(0,r.useState)("overview"),[J,K]=(0,r.useState)("appointments"),[Q,Z]=(0,r.useState)([]),[ee,es]=(0,r.useState)(!1),[et,ea]=(0,r.useState)(null),[er,ei]=(0,r.useState)(null),[el,en]=(0,r.useState)(!1),[eo,ed]=(0,r.useState)([]),[ec,em]=(0,r.useState)(!1),[ex,eg]=(0,r.useState)(!1),[eu,eh]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{console.log("Fetching user profile...");let e=await (0,P.sh)();console.log("User profile fetched:",e),ei(e),e||console.log("Auth user (for debugging):",await (0,P.HW)())})()},[]),(0,r.useEffect)(()=>{ep()},[E.id]);let ep=async()=>{try{V(!0);let e=await (0,k.bG)(E.id);T(e),en(!0);try{let e=await q(E.id);Z(e)}catch(e){console.error("Error fetching vitals data:",e)}finally{en(!1)}em(!0);try{let e=await F(E.id);ed(e)}catch(e){console.error("Error fetching medical history data:",e)}finally{em(!1)}}catch(e){console.error("Error fetching patient data:",e),H(e instanceof Error?e.message:"Failed to load patient data")}finally{V(!1)}},ey=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not specified",eb=e=>e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Not specified";return B?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-orange-200 border-t-orange-500 rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading patient data..."})]})}):G?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Patient"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:G}),(0,a.jsx)(Y(),{href:"/patients",children:(0,a.jsx)("button",{className:"bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600 transition-colors",children:"Back to Patients"})})]})}):I?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(Y(),{href:"/patients",children:(0,a.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,a.jsx)(n.A,{className:"h-5 w-5 text-gray-600"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:I.name}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[(0,a.jsx)("span",{className:"text-lg font-mono text-orange-600",children:I.patient_id}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(null==e?void 0:e.toLowerCase()){case"critical":return"text-red-500 bg-red-50 border-red-200";case"stable":return"text-green-500 bg-green-50 border-green-200";case"recovering":return"text-orange-500 bg-orange-50 border-orange-200";case"active":return"text-blue-500 bg-blue-50 border-blue-200";default:return"text-gray-500 bg-gray-50 border-gray-200"}})(I.status)),children:(null==(s=I.status)?void 0:s.charAt(0).toUpperCase())+(null==(t=I.status)?void 0:t.slice(1))||"Active"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:()=>R.push("/patients/".concat(I.patient_id,"/edit")),className:"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),"Edit Patient"]}),(0,a.jsxs)("button",{onClick:()=>eh(!0),className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),"Prescribe Medicine"]}),(0,a.jsxs)("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"New Appointment"]})]})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(l.A,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"Personal Information"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-gray-400 mr-3"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Age:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[(e=>{let s=new Date(e),t=new Date,a=t.getFullYear()-s.getFullYear(),r=t.getMonth()-s.getMonth();return(r<0||0===r&&t.getDate()<s.getDate())&&a--,a})(I.date_of_birth)," years"]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(l.A,{className:"h-4 w-4 text-gray-400 mr-3"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Gender:"}),(0,a.jsx)("span",{className:"ml-2 font-medium capitalize",children:I.gender})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 text-gray-400 mr-3"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Phone:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:I.phone})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-gray-400 mr-3"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Email:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:I.email})]}),(0,a.jsxs)("div",{className:"flex items-start text-sm",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 text-gray-400 mr-3 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Address:"}),(0,a.jsx)("p",{className:"ml-2 font-medium",children:I.address})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(h.A,{className:"h-5 w-5 text-green-600"})}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"Medical Information"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 text-gray-400 mr-3"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Blood Group:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:I.blood_group||"Not specified"})]}),I.allergies&&(0,a.jsxs)("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:[(0,a.jsxs)("div",{className:"flex items-center text-red-700 text-sm font-medium mb-1",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Allergies"]}),(0,a.jsx)("p",{className:"text-red-600 text-sm",children:I.allergies})]}),I.initial_symptoms&&(0,a.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[(0,a.jsxs)("div",{className:"flex items-center text-yellow-700 text-sm font-medium mb-1",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Initial Symptoms"]}),(0,a.jsx)("p",{className:"text-yellow-600 text-sm",children:I.initial_symptoms})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(b.A,{className:"h-5 w-5 text-purple-600"})}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:"Admission Information"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[I.admission_date&&(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 text-gray-400 mr-3"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Admitted:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:eb(I.admission_date)})]}),I.admission_type&&(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(f.A,{className:"h-4 w-4 text-gray-400 mr-3"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Type:"}),(0,a.jsx)("span",{className:"ml-2 font-medium capitalize",children:I.admission_type})]}),I.department_ward&&(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 text-gray-400 mr-3"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Department:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:I.department_ward})]}),I.room_number&&(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 text-gray-400 mr-3"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Room:"}),(0,a.jsx)("span",{className:"ml-2 font-medium",children:I.room_number})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",name:"Overview",icon:N.A},{id:"vitals",name:"Vitals",icon:v.A},{id:"medical-history",name:"Medical History",icon:h.A},{id:"medications",name:"Medications",icon:d.A},{id:"appointments",name:"Appointments & Admissions",icon:m.A},{id:"billing",name:"Billing",icon:f.A}].map(e=>(0,a.jsxs)("button",{onClick:()=>W(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ".concat(U===e.id?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,a.jsx)(e.icon,{className:"h-4 w-4"}),e.name]},e.id))})}),(0,a.jsxs)("div",{className:"p-6",children:["overview"===U&&(0,a.jsxs)("div",{className:"space-y-6",children:[I.primary_complaint&&(0,a.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[(0,a.jsxs)("h4",{className:"font-medium text-orange-900 mb-2 flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-4 w-4"}),"Primary Complaint / Reason for Visit"]}),(0,a.jsx)("p",{className:"text-orange-800",children:I.primary_complaint})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[I.referring_doctor_facility&&(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Referring Doctor/Facility"}),(0,a.jsx)("p",{className:"text-blue-800",children:I.referring_doctor_facility})]}),I.referred_by&&(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[(0,a.jsx)("h4",{className:"font-medium text-green-900 mb-2",children:"Referred By"}),(0,a.jsx)("p",{className:"text-green-800",children:I.referred_by})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-4",children:"Recent Activity"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-3"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-900",children:"Patient registered"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:eb(I.created_at)})]})]}),I.admission_date&&(0,a.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full mr-3"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-900",children:"Patient admitted"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:eb(I.admission_date)})]})]})]})]})]}),"vitals"===U&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Patient Vitals"}),(0,a.jsxs)("button",{onClick:()=>{ea(null),es(!0)},className:"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"Record New Vitals"]})]}),el?(0,a.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-orange-200 border-t-orange-500 rounded-full animate-spin"})}):0===Q.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[(0,a.jsx)(v.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No vitals recorded"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Get started by recording new vitals for this patient."}),(0,a.jsx)("button",{onClick:()=>{ea(null),es(!0)},className:"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors",children:"Record First Vitals"})]}):(0,a.jsx)("div",{className:"space-y-4",children:Q.map(e=>{var s;return(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4 relative",children:[e.alerts&&e.alerts.length>0&&(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-1 bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium",children:[(0,a.jsx)(p.A,{className:"h-3 w-3"}),e.alerts.length," Alert",e.alerts.length>1?"s":""]})}),(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900",children:["Recorded on ",new Date(e.recorded_at).toLocaleString()]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,a.jsxs)("span",{children:["Recorded by: ",(null==(s=e.recorded_by_user)?void 0:s.name)||"Unknown"]}),e.recording_location&&(0,a.jsxs)("span",{children:["Location: ",e.recording_location]}),e.recording_device&&(0,a.jsxs)("span",{children:["Device: ",e.recording_device]}),e.version>1&&(0,a.jsxs)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:["v",e.version]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.is_validated&&(0,a.jsxs)("div",{className:"flex items-center gap-1 bg-green-100 text-green-800 px-2 py-1 rounded text-xs",children:[(0,a.jsx)(_.A,{className:"h-3 w-3"}),"Validated"]}),(0,a.jsx)("button",{onClick:()=>{ea(e),es(!0)},className:"text-orange-500 hover:text-orange-700 text-sm font-medium",children:"Edit"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.blood_pressure_systolic&&e.blood_pressure_diastolic&&(0,a.jsxs)("div",{className:"bg-red-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-red-600 font-medium",children:"Blood Pressure"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-red-800",children:[e.blood_pressure_systolic,"/",e.blood_pressure_diastolic]}),(0,a.jsx)("p",{className:"text-xs text-red-600",children:"mmHg"})]}),e.heart_rate&&(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-blue-600 font-medium",children:"Heart Rate"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-blue-800",children:[e.heart_rate," ",(0,a.jsx)("span",{className:"text-sm",children:"bpm"})]})]}),e.temperature&&(0,a.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-yellow-600 font-medium",children:"Temperature"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-yellow-800",children:[e.temperature,"\xb0F"]})]}),e.oxygen_saturation&&(0,a.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-green-600 font-medium",children:"Oxygen Saturation"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-green-800",children:[e.oxygen_saturation,"%"]})]}),e.respiratory_rate&&(0,a.jsxs)("div",{className:"bg-cyan-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-cyan-600 font-medium",children:"Respiratory Rate"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-cyan-800",children:[e.respiratory_rate," ",(0,a.jsx)("span",{className:"text-sm",children:"bpm"})]})]}),e.weight&&(0,a.jsxs)("div",{className:"bg-purple-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-purple-600 font-medium",children:"Weight"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-purple-800",children:[e.weight," ",(0,a.jsx)("span",{className:"text-sm",children:"kg"})]})]}),e.height&&(0,a.jsxs)("div",{className:"bg-indigo-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-indigo-600 font-medium",children:"Height"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-indigo-800",children:[e.height," ",(0,a.jsx)("span",{className:"text-sm",children:"cm"})]})]}),e.bmi&&(0,a.jsxs)("div",{className:"bg-teal-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-teal-600 font-medium",children:"BMI"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-teal-800",children:e.bmi})]}),e.blood_glucose&&(0,a.jsxs)("div",{className:"bg-pink-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-pink-600 font-medium",children:"Blood Glucose"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-pink-800",children:[e.blood_glucose," ",(0,a.jsx)("span",{className:"text-sm",children:"mg/dL"})]})]}),void 0!==e.pain_scale&&null!==e.pain_scale&&(0,a.jsxs)("div",{className:"bg-orange-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-orange-600 font-medium",children:"Pain Scale"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-orange-800",children:[e.pain_scale,"/10"]})]})]}),e.notes&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-100",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium",children:"Notes:"})," ",e.notes]})}),(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-100 flex justify-between items-center text-xs text-gray-500",children:(0,a.jsx)("div",{className:"flex items-center gap-4",children:e.updated_at!==e.created_at&&(0,a.jsxs)("span",{children:["Last updated: ",new Date(e.updated_at).toLocaleString()]})})})]},e.id)})})]}),"medical-history"===U&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Medical History Timeline"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>eg(!0),className:"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"Add Medical Event"]}),(null==I?void 0:I.id)&&(0,a.jsx)(L,{patientId:I.id,onSuccess:async()=>{em(!0);try{let e=await F(I.id);ed(e)}catch(e){console.error("Error fetching medical history:",e)}finally{em(!1)}}})]})]}),ec?(0,a.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-orange-200 border-t-orange-500 rounded-full animate-spin"})}):0===eo.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[(0,a.jsx)(h.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No medical history found"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"No medical events have been recorded for this patient."}),(0,a.jsx)("button",{onClick:()=>eg(!0),className:"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors",children:"Record First Medical Event"})]}):(0,a.jsx)("div",{className:"space-y-6",children:eo.map(e=>(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-orange-500 rounded-full"}),(0,a.jsx)("div",{className:"w-px h-full bg-gray-300"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-700",children:e.event_name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[new Date(e.event_date).toLocaleDateString()," - ",e.event_type]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.details}),e.doctor_name&&(0,a.jsxs)("p",{className:"text-sm text-blue-600 mt-1",children:["Doctor: ",e.doctor_name]}),e.facility_name&&(0,a.jsxs)("p",{className:"text-sm text-purple-600 mt-1",children:["Facility: ",e.facility_name]})]})]},e.id))}),ex&&(null==I?void 0:I.id)&&(0,a.jsx)(M,{patientId:I.id,onClose:()=>eg(!1),onSuccess:async()=>{em(!0);try{let e=await F(I.id);ed(e)}catch(e){console.error("Error fetching medical history:",e)}finally{em(!1)}}})]}),"medications"===U&&(0,a.jsx)(O,{patientId:I.id}),"appointments"===U&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"flex space-x-8",children:[(0,a.jsxs)("button",{onClick:()=>K("appointments"),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ".concat("appointments"===J?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),"Appointments"]}),(0,a.jsxs)("button",{onClick:()=>K("admissions"),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ".concat("admissions"===J?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,a.jsx)(S.A,{className:"h-4 w-4"}),"Admission History"]})]})}),"appointments"===J&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Appointment History"}),(0,a.jsxs)("button",{className:"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"New Appointment"]})]}),I.appointments&&I.appointments.length>0?(0,a.jsx)("div",{className:"space-y-3",children:I.appointments.map((e,s)=>{var t,r;return(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.type}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[ey(e.appointment_date)," at ",e.appointment_time]}),e.doctor&&(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Dr. ",(null==(t=e.doctor.user)?void 0:t.name)||"Unknown"," - ",(null==(r=e.doctor.user)?void 0:r.specialization)||"General"]}),e.symptoms&&(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Symptoms: ",e.symptoms]})]}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("completed"===e.status?"bg-green-100 text-green-800":"scheduled"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.status})]})},s)})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(m.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No appointments found"})]})]}),"admissions"===J&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Admission & Discharge History"})}),I.bed_allocations&&I.bed_allocations.length>0?(0,a.jsx)("div",{className:"space-y-3",children:I.bed_allocations.map((e,s)=>{var t,r;return(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg ".concat("active"===e.status?"bg-green-100":"discharged"===e.status?"bg-blue-100":"bg-gray-100"),children:"active"===e.status?(0,a.jsx)(A.A,{className:"h-4 w-4 ".concat("active"===e.status?"text-green-600":"discharged"===e.status?"text-blue-600":"text-gray-600")}):(0,a.jsx)(D.A,{className:"h-4 w-4 ".concat("active"===e.status?"text-green-600":"discharged"===e.status?"text-blue-600":"text-gray-600")})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-medium text-gray-900",children:"active"===e.status?"Current Admission":"Previous Admission"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Bed: ",(null==(t=e.bed)?void 0:t.bed_number)||"N/A"," • Room: ",(null==(r=e.bed)?void 0:r.room_number)||"N/A"]})]})]}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-100 text-green-800":"discharged"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.status})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Admission Date:"}),(0,a.jsx)("p",{className:"font-medium",children:eb(e.admission_date)})]}),e.discharge_date&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Discharge Date:"}),(0,a.jsx)("p",{className:"font-medium",children:eb(e.discharge_date)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Admission Type:"}),(0,a.jsx)("p",{className:"font-medium",children:e.admission_type||"N/A"})]}),e.reason&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Reason:"}),(0,a.jsx)("p",{className:"font-medium",children:e.reason})]}),e.daily_charges&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Daily Charges:"}),(0,a.jsxs)("p",{className:"font-medium",children:["₹",e.daily_charges]})]}),e.total_charges&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Total Charges:"}),(0,a.jsxs)("p",{className:"font-medium",children:["₹",e.total_charges]})]})]}),"active"===e.status&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Currently admitted"]})})]},s)})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(S.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No admission history found"})]})]})]}),"billing"===U&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Billing Information"}),(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(f.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Billing information will be available soon"})]})]})]})]})]}),ee&&I&&(0,a.jsx)(X,{patientId:I.patient_id,onClose:()=>{es(!1),ea(null)},onVitalsRecorded:()=>{ep()},editingVital:et,currentUser:er}),eu&&I&&(0,a.jsx)(z,{patientId:I.patient_id,patientName:I.name,currentUser:er,onClose:()=>eh(!1),onPrescriptionCreated:()=>{ep()}})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(l.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Patient Not Found"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"The requested patient could not be found."}),(0,a.jsx)(Y(),{href:"/patients",children:(0,a.jsx)("button",{className:"bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600 transition-colors",children:"Back to Patients"})})]})})}function X(e){let{patientId:s,onClose:t,onVitalsRecorded:i,editingVital:l,currentUser:n}=e,[o,d]=(0,r.useState)({bloodPressureSystolic:"",bloodPressureDiastolic:"",heartRate:"",temperature:"",respiratoryRate:"",oxygenSaturation:"",weight:"",height:"",bloodGlucose:"",painScale:"",notes:""}),[c,m]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(l){var e,s,t,a,r,i,n,o,c,m;d({bloodPressureSystolic:(null==(e=l.blood_pressure_systolic)?void 0:e.toString())||"",bloodPressureDiastolic:(null==(s=l.blood_pressure_diastolic)?void 0:s.toString())||"",heartRate:(null==(t=l.heart_rate)?void 0:t.toString())||"",temperature:(null==(a=l.temperature)?void 0:a.toString())||"",respiratoryRate:(null==(r=l.respiratory_rate)?void 0:r.toString())||"",oxygenSaturation:(null==(i=l.oxygen_saturation)?void 0:i.toString())||"",weight:(null==(n=l.weight)?void 0:n.toString())||"",height:(null==(o=l.height)?void 0:o.toString())||"",bloodGlucose:(null==(c=l.blood_glucose)?void 0:c.toString())||"",painScale:(null==(m=l.pain_scale)?void 0:m.toString())||"",notes:l.notes||""})}},[l]);let u=e=>{let{name:s,value:t}=e.target;d(e=>({...e,[s]:t}))},h=async e=>{e.preventDefault(),m(!0),g(null);try{let e={patientId:s,recordedBy:(null==n?void 0:n.id)||null,bloodPressureSystolic:o.bloodPressureSystolic?parseInt(o.bloodPressureSystolic):void 0,bloodPressureDiastolic:o.bloodPressureDiastolic?parseInt(o.bloodPressureDiastolic):void 0,heartRate:o.heartRate?parseInt(o.heartRate):void 0,temperature:o.temperature?parseFloat(o.temperature):void 0,respiratoryRate:o.respiratoryRate?parseInt(o.respiratoryRate):void 0,oxygenSaturation:o.oxygenSaturation?parseInt(o.oxygenSaturation):void 0,weight:o.weight?parseFloat(o.weight):void 0,height:o.height?parseFloat(o.height):void 0,bloodGlucose:o.bloodGlucose?parseInt(o.bloodGlucose):void 0,painScale:o.painScale?parseInt(o.painScale):void 0,notes:o.notes||void 0};l?await R(l.id,e):await E(e),i(),t()}catch(e){console.error("Error recording vitals:",e),g(e instanceof Error?e.message:"Failed to record vitals")}finally{m(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:l?"Edit Vitals":"Record New Vitals"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(C.A,{className:"h-6 w-6"})})]}),x&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:x}),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Systolic BP (mmHg)"}),(0,a.jsx)("input",{type:"number",name:"bloodPressureSystolic",value:o.bloodPressureSystolic,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Diastolic BP (mmHg)"}),(0,a.jsx)("input",{type:"number",name:"bloodPressureDiastolic",value:o.bloodPressureDiastolic,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heart Rate (bpm)"}),(0,a.jsx)("input",{type:"number",name:"heartRate",value:o.heartRate,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Temperature (\xb0C)"}),(0,a.jsx)("input",{type:"number",step:"0.1",name:"temperature",value:o.temperature,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Respiratory Rate (bpm)"}),(0,a.jsx)("input",{type:"number",name:"respiratoryRate",value:o.respiratoryRate,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Oxygen Saturation (%)"}),(0,a.jsx)("input",{type:"number",name:"oxygenSaturation",value:o.oxygenSaturation,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight (kg)"}),(0,a.jsx)("input",{type:"number",step:"0.1",name:"weight",value:o.weight,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height (cm)"}),(0,a.jsx)("input",{type:"number",step:"0.1",name:"height",value:o.height,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blood Glucose (mg/dL)"}),(0,a.jsx)("input",{type:"number",name:"bloodGlucose",value:o.bloodGlucose,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pain Scale (0-10)"}),(0,a.jsx)("input",{type:"number",min:"0",max:"10",name:"painScale",value:o.painScale,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,a.jsx)("textarea",{name:"notes",value:o.notes,onChange:u,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Additional notes about the patient's condition..."})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",disabled:c,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:opacity-50",disabled:c,children:c?"Saving...":l?"Update Vitals":"Record Vitals"})]})]})]})})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[8800,2500,6550,774,1563,8441,1684,7358],()=>s(1090)),_N_E=e.O()}]);